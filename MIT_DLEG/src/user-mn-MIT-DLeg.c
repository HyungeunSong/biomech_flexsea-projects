/****************************************************************************
	[Project] FlexSEA: Flexible & Scalable Electronics Architecture
	[Sub-project] 'flexsea-user' User projects
	Copyright (C) 2016 Dephy, Inc. <http://dephy.com/>

	This program is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.

	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with this program.  If not, see <http://www.gnu.org/licenses/>.
*****************************************************************************
	[Lead developer] Luke Mooney, lmooney at dephy dot com.
	[Origin] Based on Jean-Francois Duval's work at the MIT Media Lab
	Biomechatronics research group <http://biomech.media.mit.edu/>
	[Contributors] Tony Shu, tony shu at mit dot edu, Matthew Carney mcarney at mit dot edu
*****************************************************************************
	[This file] user-mn-MIT_DLeg_2dof: User code running on Manage
*****************************************************************************/

#if defined INCLUDE_UPROJ_MIT_DLEG || defined BOARD_TYPE_FLEXSEA_PLAN
#if defined BOARD_TYPE_FLEXSEA_MANAGE || defined BOARD_TYPE_FLEXSEA_PLAN

//****************************************************************************
// Include(s)
//****************************************************************************
#if defined BOARD_TYPE_FLEXSEA_MANAGE
#include "arm_math.h"
#endif

#include "user-mn.h"
#include "user-mn-MIT-DLeg.h"
#include "user-mn-ActPack.h"
#include "state_variables.h"
#include "user-mn-MIT-EMG.h"
#include "mn-MotorControl.h"
#include "flexsea_sys_def.h"
#include "flexsea_system.h"
#include "flexsea_cmd_calibration.h"
#include "flexsea_user_structs.h"
#include "flexsea_cmd_biomech.h"
//#include "software_filter.h"
#include "hardware_filter.h"
#include <flexsea_comm.h>
#include <math.h>
#include <sys/time.h>
#include <time.h>
#include <stdio.h>
#include <unistd.h>

#include "task_machine.h"
#include "kinematics_methods.h"
#include "machine_learning_methods.h"

//****************************************************************************
// Variable(s)
//****************************************************************************

//Variables which aren't static may be updated by Plan in the future

uint8_t mitDlegInfo[2] = {PORT_RS485_2, PORT_RS485_2};

Act_s act1;

//SAFETY FLAGS - in addition to enum, so can be cleared but don't lose other flags that may exist.
static int8_t isSafetyFlag = 0;
static int8_t isAngleLimit = 0;
static int8_t isTorqueLimit = 0;
static int8_t isTempLimit = 0;
static int8_t startedOverLimit = 1;
uint16_t commandTimer = 0;

int8_t isEnabledUpdateSensors = 0;
int8_t fsm1State = -2;
float currentScalar = CURRENT_SCALAR_INIT;
int32_t currentOpLimit = CURRENT_LIMIT_INIT; 	//operational limit for current.

//torque gain values
float torqueKp = TORQ_KP_INIT;
float torqueKi = TORQ_KI_INIT;
float torqueKd = TORQ_KD_INIT;

//current gain values
int16_t currentKp = ACTRL_I_KP_INIT;
int16_t currentKi = ACTRL_I_KI_INIT;
int16_t currentKd = ACTRL_I_KD_INIT;

//motor param terms
float motJ = MOT_J;
float motB = MOT_B;

int32_t motSticNeg = MOT_STIC_NEG;
int32_t motSticPos = MOT_STIC_POS;

//const vars taken from defines (done to speed up computation time)
static const float angleUnit    = ANG_UNIT;
static const float jointHSMin   = JOINT_HS_MIN;
static const float jointHSMax   = JOINT_HS_MAX;
static const float jointZeroAbs = JOINT_ZERO_ABS;
static const float jointZero	= JOINT_ZERO;

static const float forceMaxTicks = FORCE_MAX_TICKS;
static const float forceMinTicks = FORCE_MIN_TICKS;
static const float forcePerTick  = FORCE_PER_TICK;

static const float nScrew = N_SCREW;

static const float jointMinSoft = JOINT_MIN_SOFT;
static const float jointMaxSoft = JOINT_MAX_SOFT;
static const float jointMinSoftDeg = JOINT_MIN_SOFT * DEG_PER_RAD;
static const float jointMaxSoftDeg = JOINT_MAX_SOFT * DEG_PER_RAD;

struct diffarr_s jnt_ang_clks;		//maybe used for velocity and accel calcs.

//30
// float feats1[] = {1.166502, 1.022724, 0.067557, -0.666128, -0.538326, -0.071083, -0.234829, -0.590702, 0.411924, 1.099519, 0.238185, 0.914524, -1.812228, 0.324357, 0.403361, -0.322672, 0.549817, 0.213795, -0.705122, -0.520561, -0.564026, -0.735377, 0.131052, -0.196445, -0.488674, 1.565122, 0.658965, -1.911723, 0.192635, -2.234602};
// float feats2[] = {0.065129, -0.356689, 1.137799, 0.684054, 1.126495, 0.155455, -1.131927, 0.739010, -0.277246, -0.374240, -0.614176, 0.118298, -0.088337, -0.035992, -0.202633, 0.049122, 0.672603, -0.124272, -0.469726, -0.348669, 0.746893, -0.605608, -1.733596, 0.567621, -1.273034, -0.850478, 0.384781, -1.334017, -1.673871, 2.063354};
// float feats3[] = {0.936018, 0.527328, -2.264470, -1.332069, -0.965124, -0.533597, 0.336066, -1.636859, 1.453649, -0.049200, 0.604961, 1.178439, 0.496581, 1.553377, -0.933918, 0.109776, -0.840349, -1.212987, -0.152785, -0.642048, -0.699867, 0.504451, 0.571085, 2.996046, 0.331938, -0.624579, -2.394627, -0.341995, 0.090592, 2.994811};
// float feats4[] = {0.305168, 1.917522, 0.116600, 0.638696, 1.007101, -1.291814, 0.096951, -1.552774, -0.057531, 0.647236, 0.342404, 0.274826, -0.558429, -1.315408, -0.931451, 1.251477, 1.284620, -0.675785, 2.081242, 2.014329, 1.110106, -0.858534, -0.141990, -1.197775, 0.025044, -0.805405, 1.112365, 0.749343, 1.337447, -0.524437};
// float feats5[] = {-0.138921, 0.402213, -1.252966, 0.813792, 1.345202, 0.549501, 1.370415, 0.536308, 0.155510, -2.555416, 0.315756, -0.367719, 0.298261, -1.546892, -0.148585, 0.478918, -0.084058, -3.037325, -0.415239, -0.319101, -0.182095, -0.072000, 2.079141, 1.321521, -0.961359, 0.783575, -1.498891, 1.227899, 0.579670, 0.369145};
// float feats6[] = {-0.996952, -0.010912, -2.216148, -0.355123, 0.488961, 1.331406, 0.784499, -1.040317, -0.056013, -1.685024, 1.601232, -0.056663, -1.112556, 0.753731, 0.517538, 1.932051, 2.132122, 0.805211, -0.192766, -0.272289, -1.536604, 0.379494, 0.118774, -0.447131, -0.267199, -1.363830, -0.099666, -1.316815, 0.006103, 0.840085};
// float feats7[] = {0.390221, -0.119863, -0.643514, 0.293129, 0.128030, 0.302107, -1.636404, -0.112933, -1.207225, -1.256915, -0.412442, 0.616554, -0.020683, -0.345776, -1.582256, 0.740685, -0.410359, 0.069210, -0.810694, 0.773602, 2.751880, 0.938886, 0.683667, -1.491699, 1.434259, 1.528500, 0.232730, -0.808108, -1.699871, -0.737919};
// float feats8[] = {-0.287670, -0.017690, -0.473186, 2.350260, -1.279076, 0.942658, -0.468498, -1.141768, 0.617926, -0.218585, -1.186374, 1.427195, -1.225876, 0.494816, -0.211699, -0.030765, 0.439849, -0.031141, 1.941229, 0.361600, 0.373513, -0.980135, 0.334052, 1.375651, -1.766364, -1.678174, 2.094170, -1.629594, -0.681852, 1.105988};
// float feats9[] = {-0.194126, -0.692525, -1.005932, -1.231536, 0.087298, 0.510711, 1.651765, -1.350106, 0.434740, -0.349488, 1.380067, -0.295593, 1.598263, -0.367515, -0.664274, 0.255553, -1.597426, 0.492513, 1.450107, 0.502774, -0.940349, 2.171599, 0.328535, 0.303356, 1.108491, 0.065946, -1.088916, 1.097453, -0.072834, 0.202254};
// float feats10[] = {0.227208, -1.151460, -0.780061, 0.167526, -0.057366, -0.124483, 2.606179, 2.375393, -0.123639, -0.085414, -1.525027, 0.847723, 0.401253, 0.948961, 0.438531, -0.252516, 0.310041, -0.884247, -0.314529, 0.556049, 1.027679, -0.692973, -0.547825, 0.325015, -1.271790, -0.900122, 0.899152, 0.958448, -1.365537, 0.323149};
// float feats11[] = {0.697784, 0.941403, 0.907457, 0.003296, 1.139741, -0.358351, 0.047301, 0.664243, 1.344589, 0.094577, 0.822593, -0.378994, 0.084884, -0.827574, 0.919391, -0.652230, 0.009614, -1.003430, 0.663683, -1.174675, -1.482881, 2.378431, 0.117567, 0.195940, 0.947596, -0.178783, -1.164732, 0.816062, 1.083714, -0.169106};
// float feats12[] = {-0.332641, 0.331019, 1.740712, -0.831483, -0.024434, -0.001032, 0.844453, 0.769042, -0.897599, 0.172417, 0.132692, 0.581859, -0.414986, -0.402015, 0.566358, -0.647553, -2.502143, 1.434292, -0.932589, 0.549845, -0.087886, 1.462875, -2.088457, 0.674762, 1.384302, 0.003990, 0.013669, -1.093142, -1.010040, -0.471007};
// float feats13[] = {-0.908693, -0.128044, -0.735093, 0.800806, 2.066256, 1.249017, 1.918558, -0.685805, 0.983659, 0.155908, 0.293254, 0.152906, 0.523666, 2.024081, 1.171585, -1.519553, 0.315311, -0.774899, 0.857255, 0.919313, 0.108541, -1.442909, 1.099257, -0.142429, 0.765202, -0.026517, -0.103548, 0.454839, -0.885371, 0.386059};
// float feats14[] = {1.372615, -0.136774, 0.399289, 0.106456, -1.942704, -0.210145, -1.295720, -1.782803, 0.564327, 0.486665, -0.337726, 0.302031, -0.358360, -2.087376, -0.518883, -0.966616, 1.137318, 1.347096, 0.900030, -0.229549, -0.031383, 0.533204, 1.810199, -1.896785, -0.013807, -0.899034, -0.180933, -0.499989, -0.319461, 0.362116};
// float feats15[] = {-0.704621, -0.597334, 0.971219, -0.931695, 1.150311, -1.590140, -0.912218, 1.148324, -0.658427, 0.004721, -0.017314, 0.421501, -2.034433, -1.348021, 0.580596, 0.456390, -0.525007, 0.890108, -0.018547, 0.216484, -0.902250, -0.754610, -0.491568, -0.393771, 1.598917, 0.870990, -0.064774, -1.412115, 1.038031, -0.788493};
// float feats16[] = {0.615420, -0.529390, -0.090688, 0.166046, 0.873617, -1.262343, 1.388247, -0.516620, 1.509623, -0.092428, -0.461555, 0.360748, 0.421430, 0.817766, 1.281151, -0.365092, 2.192969, -0.818580, 0.867939, 0.224681, 1.730264, -0.349441, 1.326400, -0.530699, -0.746935, 0.456256, -0.419482, 1.536863, 0.802445, -0.200947};
// float feats17[] = {2.565342, -0.368172, 1.522593, 0.077287, -0.003087, 0.070644, 1.220240, 0.707263, 1.873883, 0.595166, -0.034528, 0.567874, 1.132704, 0.338548, 1.513343, -0.712011, -2.442984, 0.034641, 0.403456, -0.481675, 0.303277, 0.714068, 0.423087, 0.221580, 2.092765, 1.220073, 0.564739, -0.244000, -0.511976, 1.003539};
// float feats18[] = {0.923503, -0.615116, 1.602434, 0.515729, -1.079562, 0.932302, 1.399238, -1.535785, -1.855417, 0.302974, -0.844279, 0.849673, 0.276329, -0.041157, 0.255177, -0.215539, 2.877537, 0.854230, 0.023591, 0.624840, 0.913942, 1.273490, -0.271883, -2.013304, 1.741039, 1.694196, -0.745297, -1.161139, -1.194565, -1.635207};
// float feats19[] = {-0.718506, 1.887268, -1.431719, -0.149504, 0.379521, 2.475090, -1.054692, 0.175728, -0.252271, -0.840467, 0.009270, 0.632354, -1.376671, 0.974834, 0.731429, 0.477594, 0.403948, 1.144744, -2.377045, -1.330892, -0.194100, 0.076648, 0.243542, 0.003596, 1.009682, -1.506507, 0.472368, 0.851807, -0.726536, 1.749744};
// float feats20[] = {-0.387323, 1.008488, 0.425981, 0.866906, -1.231384, -0.159244, -0.149662, -0.345250, -0.412166, 0.734273, 2.203056, -2.280327, -0.131797, -0.341447, -0.221116, -0.869798, 1.437002, 0.602007, -0.973193, -0.594935, -0.677326, -0.777454, 0.547671, -1.071513, -0.593703, -0.162455, -2.539242, -0.528294, 2.005471, 0.656673};
// float feats21[] = {-0.026172, -0.193664, 0.996665, 1.405693, 0.314674, 1.038147, -1.457857, -0.804201, 0.195388, 0.314515, 0.514082, -0.832340, 1.601272, 0.043119, 0.135801, 0.257148, -0.811097, -0.190559, 0.491686, -0.146160, -1.079208, 0.496343, -1.387960, 1.859545, 1.429142, -1.042721, -0.234501, -0.650312, 1.247211, -0.208431};
// float feats22[] = {1.342252, -0.712475, -0.594581, -2.179934, 0.563473, -0.165415, 1.626611, 0.987846, -1.254994, 0.328141, -0.471622, -0.187332, 1.471662, 0.914813, -0.255206, 0.641269, 0.935336, 1.357188, -0.182948, 0.372948, 1.022507, -0.038253, 0.937082, -0.647352, 0.002938, 0.078965, 1.336523, 1.137383, 0.807534, -0.873695};
// float feats23[] = {1.691389, 0.612212, -2.004325, 0.679736, 0.651460, 0.949351, 0.232874, 0.085696, 1.362592, 0.556041, -0.301054, -0.442414, -0.267689, 0.922693, 0.012493, -0.541547, 1.574398, -1.316534, 1.480899, -0.675121, -0.300547, -0.027933, -1.728143, 0.744336, 0.198144, -0.347257, -0.513112, 0.051132, -0.727788, 0.267384};
// float feats24[] = {-0.159161, 0.945076, -1.401921, -0.174267, -0.933642, 1.746364, -2.159359, 1.638982, -0.056697, 0.507210, -0.630728, 0.042847, -0.146984, 0.688501, -1.184344, -0.546694, 0.150155, 0.001618, 0.535071, 0.291739, -0.937374, -1.021336, 0.623881, 0.073119, -0.981847, -0.893962, -0.028786, 0.672752, -0.543604, 1.115975};
// float feats25[] = {0.135689, -0.031974, -0.400192, 0.288326, -1.837729, 1.054028, -1.247909, -0.774669, 1.184253, -0.208435, -0.364527, 0.205422, 1.009899, 0.437200, 0.460897, 0.058604, -0.728663, 1.140423, 0.683484, -0.451780, 0.698325, -0.723097, -0.514417, -1.466625, 0.978755, 0.857265, -0.560790, 0.264055, -0.186271, 1.723076};
// float feats26[] = {0.343996, -1.693860, 0.698234, 1.296542, 0.516374, 0.536318, -0.648991, 1.605438, -0.695839, 1.087275, 0.573568, -0.371694, -0.369961, 1.581359, 1.799802, 0.312623, 1.580260, -0.545113, 0.624565, 1.079464, 0.557363, -0.714660, 1.529545, 1.403535, -0.483406, 0.685883, 0.156381, -0.021347, -0.120071, -0.828964};
// float feats27[] = {-0.979682, 0.490579, 2.300577, 0.797212, 0.092435, -0.208166, 0.452245, -1.080115, -0.176884, 0.680877, -0.708655, -0.453800, 0.066925, 2.188748, -0.843406, -0.321299, -0.456807, 0.235780, 1.399139, 0.555444, 0.517933, 1.319355, 0.312915, -0.364849, 1.748098, -0.329512, -0.275474, -0.786745, 0.211571, 1.175719};
// float feats28[] = {1.045460, -0.136212, -1.391937, 1.019350, 0.432198, 0.427533, 0.966960, 2.275787, -0.274106, 0.421413, 1.235836, -0.205685, -2.019465, 0.984180, -0.608389, -0.680649, 0.069645, -1.021813, -0.932088, -0.995969, 1.622199, -0.352148, 1.183882, -1.696624, 1.153215, -0.987732, -2.164952, 1.075998, -0.486559, -0.420593};
// float feats29[] = {-0.754279, -0.297937, 1.633605, 1.740353, -0.387603, -0.937247, -0.530947, -0.508134, -0.780966, 0.032849, 0.145103, 0.385399, 0.330965, -0.468580, -1.065857, -0.870936, -2.753636, 2.150905, 0.428021, -1.457961, 0.895864, 0.302360, 2.039383, -0.147511, 0.657089, -0.082981, -1.562645, -1.635340, -0.613712, 1.277361};
// float feats30[] = {0.908098, -1.169540, 0.217954, 1.028629, -1.687696, -0.829249, 0.422926, -0.144375, 0.082787, 0.846514, 1.475916, -0.561643, -0.724439, -0.544820, 0.049614, -0.063159, -0.097197, 0.996542, 1.607909, -1.006619, -0.837397, -0.702836, 0.291861, 1.925387, 0.310931, -0.068679, -1.399186, -0.841993, 1.739244, -1.391845};
// float feats31[] = {1.048696, 1.031668, -0.132304, -0.449076, -0.253810, -0.466220, -0.302183, 0.712616, 1.122653, -1.812617, -0.902111, -1.015809, -0.457556, 0.414412, 0.205709, 1.076505, 0.537493, -0.206733, 0.577263, -0.424159, -0.837579, 1.717590, -1.399443, -2.137237, -0.177916, 1.150579, -0.270354, 0.111142, -0.823813, 0.805206};
// float feats32[] = {1.133922, -0.310852, 0.484361, 0.146101, 1.381580, -0.089049, 0.133706, -1.222615, -0.221645, -0.046313, -0.245347, 0.691193, 1.084930, -0.502696, 1.248676, -0.622148, -0.784279, 1.582432, -0.002072, -0.317949, 0.467938, -2.628884, 1.836118, -1.461103, 0.471332, -0.165654, 0.722706, 0.293778, -2.474074, -0.114626};
// float feats33[] = {-1.280157, 1.138117, -0.722764, 1.485766, -1.717433, 0.108595, 0.182067, 0.047956, 0.032832, -2.061667, 0.642252, -1.190354, 0.227828, -1.172397, -0.947916, -0.938326, -0.054031, -0.526471, 0.878168, -0.890207, 1.052044, 0.947976, 1.342413, -0.756573, 1.246257, -0.283991, -0.127418, -1.302489, 0.245463, 0.261216};
// float feats34[] = {-0.821602, -0.571221, -0.936103, -1.130612, -0.201869, -0.554042, 0.215348, 0.668812, -0.187746, 0.291750, 0.333411, 0.030865, -0.033872, 0.528934, 0.205574, -1.109216, 1.301772, -1.110243, 0.025087, 1.593465, 1.342606, 0.919399, 1.013725, -0.521595, -1.842534, -1.570793, -1.063351, -0.593679, -0.772860, -0.933626};
// float feats35[] = {-1.904525, 0.409660, 0.291053, 0.960502, 0.648591, -0.158227, -0.912912, 0.186076, -1.732741, 0.985659, -1.778229, -0.824966, 0.518507, -0.888953, 1.254579, 0.073577, 0.985729, 1.424360, 0.502005, 1.032008, 0.017523, -1.806696, 0.435862, -0.663078, 0.537091, 0.489160, -1.784285, -0.421839, 1.492724, -0.919019};
// float feats36[] = {-0.833918, -0.654330, 0.161103, 0.393427, -0.369502, -0.520440, 1.625064, -4.101136, -0.206003, -0.365772, 0.409076, 0.269610, -1.244192, 2.236516, -1.520806, 0.816167, 2.190949, 1.854945, -0.336796, -0.475750, 1.708358, 1.380547, -1.307661, -0.882339, -0.395551, 0.607558, 1.790648, 0.560089, 0.310157, -0.722640};
// float feats37[] = {-0.876400, -0.234283, -0.380801, 1.896551, 1.296358, -0.460139, -1.194483, 0.424451, -1.742309, -0.405408, -0.551157, 0.780281, -0.772733, -0.812497, 1.022139, 0.790320, 0.197770, -1.516575, -0.446318, 2.086468, -2.495064, 0.014589, 0.860206, 0.049862, 0.862958, -1.014936, -0.508793, 0.386045, 0.573092, 0.297696};
// float feats38[] = {-0.149858, -0.357339, 0.166414, -0.314348, -0.567678, -0.593995, -0.822567, -0.782983, -0.893920, 1.277218, -0.116583, 1.185899, 0.861017, 0.980345, -1.187593, -0.207269, 0.630951, 0.487793, -0.118618, -0.499946, 0.393434, 0.551405, -0.244856, -0.988565, -0.134911, -0.620021, 0.691627, 0.072596, -1.116026, 0.524470};
// float feats39[] = {0.163554, -0.247860, 0.067558, 0.377013, -0.548237, 0.623724, -1.007643, 0.263111, -1.155391, -0.652330, 0.641817, 0.284215, 0.218776, -1.038146, -0.621438, 0.730339, 1.679724, -1.634838, -1.078905, 1.149035, 0.335979, 1.719990, -0.254024, -1.682072, -1.339915, -0.818688, 0.362691, -0.791442, -0.648591, 0.067787};
// float feats40[] = {-1.617303, 0.329593, -2.403037, 1.470230, 2.885407, 1.155236, -0.813905, -0.360851, 0.575913, 0.029397, 1.222554, 0.534583, -1.239407, -0.628413, -0.969877, -1.069860, -0.945567, -0.096851, -1.640971, 0.513630, 2.154406, 0.694212, 0.019358, 0.454030, -0.790122, 0.756860, -1.222724, 1.861438, -1.140182, -1.725718};
// float feats41[] = {1.817316, -0.111884, 0.701749, 1.506629, 0.782252, -1.943020, -1.394018, 0.515118, 0.386119, 1.595625, 0.969558, -1.524075, -1.905337, -0.410068, -0.238534, -0.376837, -0.751186, 1.310365, 0.507929, -0.734505, 1.422864, -0.934832, -1.000298, -0.196407, 0.760880, -0.269290, 0.102654, 0.320521, 0.633913, 0.181415};
// float feats42[] = {-0.680206, -0.049035, -0.649846, -0.859958, -0.895033, 0.643600, 0.309085, 0.048328, 0.213772, 0.311192, -0.209218, -0.603757, -0.277399, 2.699995, -0.378662, 1.307660, -1.105928, -0.741329, -0.254011, 1.745197, -0.641831, -0.942988, -1.956373, -0.278399, -0.497949, 0.139069, 1.058243, 0.303644, -1.574795, 1.351054};
// float feats43[] = {1.098139, 0.512165, -0.860701, -1.504702, -0.424281, 1.477743, 1.964814, -1.953531, -0.619459, 0.974036, -1.060628, 0.086926, 1.066582, 0.271566, 0.473833, -1.012621, 0.434605, -1.053931, 0.420945, 0.124325, -0.228020, 0.402964, -0.559546, 0.723962, -1.230444, 0.056357, 0.699983, 2.357482, -0.570386, -1.205248};
// float feats44[] = {-0.527835, -1.802370, 1.541454, -0.302505, 0.114608, -0.149531, -0.092918, 1.609799, -1.214520, 0.794212, -0.244225, -0.167134, 1.943767, -0.961927, -0.886395, -0.034203, -1.296618, -0.968839, -0.987772, -0.683966, 1.219347, 0.458407, -0.359843, -0.414983, 1.865001, 1.546453, 0.682847, 0.234906, 1.299911, 1.039886};
// float feats45[] = {-0.796742, -0.136041, -0.249512, 0.735080, 1.118131, -1.150250, 1.501460, -1.134191, 0.826812, 0.059844, 0.049429, 1.805376, -0.907151, 0.295847, 0.018294, 0.193377, 0.663406, 1.998076, 0.386572, -0.495510, -1.052806, 0.728943, 0.041882, 1.421824, 0.034007, -0.398946, -0.654903, -0.011900, 0.617781, 0.650650};
// float feats46[] = {0.188810, 0.191081, 0.078309, -0.273796, -1.625377, 1.212513, -0.165886, -1.411777, 0.396844, -0.108303, 1.735588, 0.565359, -0.605252, -1.197375, 0.261223, -0.226663, 1.206128, -0.057498, 2.384415, 0.029690, -0.914232, 0.138714, -0.392783, -1.028401, -1.244584, -2.030035, -0.140449, -0.001584, -1.119290, 1.162230};
// float feats47[] = {-0.269592, 0.203082, 0.391480, -0.249186, -0.073376, -0.775736, -0.407399, 0.118283, 0.017862, 0.480239, -1.325087, -0.980856, 0.188681, 1.473409, -0.398833, 0.238906, -0.094349, 0.200546, -0.167193, -0.715826, 0.915655, 1.286259, 0.333228, -2.539167, -0.586182, 2.230998, -1.506761, -2.406153, 0.034845, 1.834754};
// float feats48[] = {1.057218, 2.480407, -0.076574, -1.174524, -1.082906, -1.243116, -1.364475, -0.399969, -1.088463, -1.023224, -0.573253, 0.238505, 1.348829, 0.123042, -0.926217, 0.248308, 1.485164, 0.453183, -0.681065, -1.218922, 0.232382, 0.900084, 1.024215, 1.104362, 0.303172, -1.321637, -0.360865, 0.417642, 1.129372, -0.936503};
// float feats49[] = {0.062713, 0.163766, 0.131149, -1.189324, 1.009926, -0.782577, -1.614709, -2.176773, -1.116407, 0.112351, 0.186115, -1.190737, -0.214809, -0.665208, -0.980725, 0.191396, 1.371086, 1.611292, 0.743475, 0.772948, -0.968689, 0.694643, -0.452043, 0.533177, -2.102454, 1.319790, -0.960314, -1.087012, 1.310619, -0.532592};
// float feats50[] = {1.125340, -0.511153, -0.152859, -0.803384, -0.916900, 0.252510, -0.686680, -1.607052, 0.775583, 1.086675, 0.366336, 0.952033, -0.768001, -1.440241, 1.331440, 0.295737, 0.288820, -1.521077, 0.345231, 0.374796, -0.690197, -0.263486, -1.392105, -0.387674, -0.833607, 0.953370, -0.006103, 1.021438, -0.292381, 0.639047};
// float feats51[] = {-0.472919, -1.268157, -1.049731, -2.190809, 0.270104, -0.432944, -0.991572, 0.592706, 3.012389, 0.960935, 0.174312, 0.487112, 0.883368, -1.261465, -1.064656, -0.132881, 0.670788, 0.480010, -1.068364, -0.105963, -0.505746, 2.118958, -0.299776, 0.149310, -0.068355, -0.123447, 0.232303, -0.737778, 0.852151, 1.371529};
// float feats52[] = {0.347482, -0.098934, 0.116657, -0.083302, 0.130557, 1.104966, 0.197955, -0.501443, 2.344052, 0.330381, -1.939140, -1.085992, -0.647198, 0.581719, -0.249426, 0.986034, -0.862215, -0.718962, 0.975691, -0.651376, -0.927185, 1.873545, 1.204919, -0.341290, 0.675013, 0.785973, -0.262124, 0.322407, 0.069664, -1.598358};
// float feats53[] = {-0.149994, 0.186304, -1.433211, 0.486891, -0.052365, 0.329795, 0.891454, -0.110823, 0.380890, 0.147129, -0.272649, -0.489966, 0.644478, -0.848461, -1.047685, 0.173080, -0.691987, -1.855441, -0.214543, -1.358997, 0.011105, -0.297232, -0.168055, 0.369413, 0.368460, -1.366641, 0.636502, 0.277269, -0.026649, -0.971684};
// float feats54[] = {-1.029752, -1.563850, 0.374675, 2.208193, 1.305902, -0.706494, -0.454207, -0.269565, -0.489984, -1.411656, 0.678129, 1.966780, 0.331668, 0.574390, 0.828471, -0.466071, 0.517878, 0.908767, 0.773066, 0.032421, -0.668136, -1.404515, 1.223115, -0.319347, 0.850422, 0.049856, -0.015392, -0.850883, 0.522542, -0.430101};
// float feats55[] = {0.147669, -0.848236, -0.018569, -0.450489, 1.649208, 0.443087, -0.002490, 0.835163, 0.558932, -0.280834, -0.630708, -1.054660, 2.131387, 0.509094, 0.414967, 1.376605, -1.030950, -1.176960, 0.174266, 0.025624, 2.136961, -1.047278, -1.549012, -1.792658, 1.006403, -0.423011, 0.184233, 0.517965, 1.870531, 0.580765};
// float feats56[] = {-1.020182, -0.979598, -0.258716, -1.412066, -1.529314, -0.014051, 0.045996, -0.763138, -0.902717, 1.739023, -1.387228, 1.955926, 0.397499, 0.769418, 1.281044, 0.446931, 0.798225, -0.090081, 0.362631, -0.105825, 0.328554, -1.497629, -0.054590, 1.416893, 0.166419, 1.582219, -0.066449, 1.733145, 0.224088, 0.876025};
// float feats57[] = {0.011306, -1.506526, -0.784796, -0.024147, -0.140051, -0.399060, 0.636944, -0.549783, -1.367680, 0.366067, 2.047470, -0.274812, 1.471787, 1.507173, 0.072931, 0.484828, -0.273027, -0.561631, 0.309791, 0.133112, 0.430704, -0.045860, 0.492619, 1.720227, 0.090864, -1.172471, -0.193816, 0.062274, -0.004534, -0.385997};
// float feats58[] = {0.138311, -0.403254, 0.069892, 0.695246, -0.867919, 0.549415, 0.322096, 1.593651, 1.601930, -1.109605, -0.345208, -0.208783, 0.820618, 0.803182, 0.394586, -1.333693, 0.137089, -1.858480, -0.402245, -0.297426, -0.283118, 0.704904, -1.224274, 1.054364, 0.551036, 1.856018, 1.224264, -0.282714, 0.373170, 0.222542};
// float feats59[] = {0.264058, -0.066355, -0.842711, 0.323947, 0.522178, 0.913540, -1.195709, -0.256232, 1.185529, -1.356822, 0.437300, 0.535922, 0.999424, -2.076659, 1.082022, 1.276950, 0.044905, -0.776699, -0.408961, 0.623553, -1.878299, 0.971035, -0.192473, 1.610619, -1.809752, 0.646103, -0.304687, -0.317017, -1.525369, 0.342549};
// float feats60[] = {-0.340409, 0.443576, 1.813725, 0.716418, 0.223096, -1.051266, -1.232609, -0.145876, 1.431718, 0.221152, -0.476480, 0.382265, 0.929570, -0.645531, 0.364974, -1.276021, 1.469108, 0.158767, 2.552994, -0.941087, -0.562148, -0.089971, -0.463642, 0.774056, -0.144296, 0.992978, -0.208284, 1.439687, 1.163324, -0.280224};
// float feats61[] = {1.327902, -0.441544, 0.327751, 0.701629, -1.126282, -0.918025, -1.210655, -0.089031, -1.541794, 0.829215, 0.101180, -0.192434, 0.600603, 0.025577, -1.943559, -1.377229, -0.701624, -1.354552, 0.502038, -0.891801, 1.179257, -0.566213, 1.397224, 1.081679, -0.856207, 0.251671, -0.494342, 0.873242, -1.891033, 0.031078};
// float feats62[] = {-0.951633, 0.805862, -0.390984, -0.379047, -0.407515, -0.580941, -0.286372, -0.288587, -0.348289, 0.860854, 1.736918, 1.464052, -0.152024, -0.331522, -0.668462, -0.011088, 2.013237, 1.354099, -0.248835, 0.401457, -1.409850, -0.916810, 0.009721, -0.382354, -1.617431, -0.014478, -0.026726, 0.435154, -2.609526, 1.906369};
// float feats63[] = {1.355416, -0.950981, -0.103351, 0.368931, -1.374023, 0.819875, 0.224178, -0.434035, -0.644728, -0.271685, -0.010588, 1.855471, 0.083011, 1.955989, 1.061292, -0.566157, -0.090806, 0.617044, 1.720488, 0.991234, -1.016720, -1.004740, -0.834903, -0.110092, 1.261213, 1.167489, -0.755702, 0.366699, 1.284415, 1.078643};
// float feats64[] = {-0.637814, -0.529600, -0.361824, -0.511608, 0.479858, 1.097378, 0.306056, -2.643326, 0.633102, -0.599202, -0.842155, -0.288992, 0.626286, -0.508740, -0.533867, -0.520999, -0.305886, 0.135376, -0.061741, 0.023985, 0.181208, 1.149214, -1.189415, 0.259975, 1.110792, -0.613858, 0.327888, 0.860504, -0.118764, 1.607559};
// float feats65[] = {0.690560, 0.311026, -0.803625, 0.124860, 1.474496, 0.442813, -1.243280, -0.467940, 0.387113, 0.579462, 1.126172, 0.100185, -1.551491, -0.003763, -0.282722, 1.261468, -1.452444, -0.901103, -0.179622, 0.559640, 1.367821, 0.045215, 0.458905, 0.517895, 1.700909, -0.557195, 0.490865, 1.141166, 0.038114, -0.306405};
// float feats66[] = {-0.051080, 0.255122, 1.448662, -0.072265, -0.297681, -0.630215, 0.251589, 1.983017, -1.324146, -0.558672, 0.529120, 0.761076, 1.094893, 0.089940, 0.352354, 1.069490, -0.626654, -0.343602, -0.304231, 1.123501, -0.580325, 0.526752, -0.471827, -0.680652, 1.092961, -1.402316, 0.249572, -0.057991, -0.455333, 0.556844};
// float feats67[] = {-1.884087, 1.169115, -0.546034, -0.397429, -0.236960, 0.598059, -0.710872, -1.031691, -1.942085, 1.397365, -1.288711, -0.063012, 0.308001, -0.588147, -2.062140, -0.461300, -0.893118, -0.327102, -0.727906, -0.835242, 1.539881, -0.548883, 1.476475, -1.800937, -0.094124, 0.427494, -1.099902, -1.601922, 1.252276, -0.832376};
// float feats68[] = {-0.506519, 0.615347, 1.945979, -1.434685, 0.971905, 1.874451, 1.136542, -0.629740, -0.379696, 0.590264, 0.361174, -0.805395, 0.723007, 0.888844, 1.783129, 0.392566, 1.011246, -0.520081, 0.152074, 0.533380, -0.675217, -1.231999, -0.392381, -0.041511, -1.175107, -1.039222, -1.519518, 1.433849, 0.267037, -0.011621};
// float feats69[] = {-1.692884, -0.972906, 0.138196, -0.391381, -1.253377, -0.041293, 1.922388, 0.011626, -0.806727, 1.682401, 0.454131, 0.271894, 0.054782, 0.260768, 1.110098, 0.520021, -1.633322, 0.492405, 0.914887, -0.656923, 0.001326, -0.068404, -0.728721, -0.010240, -1.245433, 0.798644, 0.162627, -1.285250, -1.227531, 0.799846};
// float feats70[] = {0.924888, 1.422843, 0.783484, -0.928254, -0.467332, -0.376038, 0.720178, -0.177449, 0.494716, 1.038994, -0.474738, -1.128321, -0.519953, 1.064618, -0.808340, 0.171903, -0.628485, -0.776537, -0.492500, -0.739927, 0.149695, 0.560998, -0.645821, -0.666598, 0.472857, 0.861771, -0.189373, -1.002089, 1.764057, -0.811374};
// float feats71[] = {-0.997844, -0.497817, -0.298498, -0.373276, -0.123626, 0.933315, -1.477576, -0.803815, 2.130822, -0.087609, 0.523893, -0.151915, -0.330073, 0.087785, -1.463148, 0.604398, -1.044830, 0.202410, 0.456825, 0.458778, -0.460231, -0.855199, 1.408730, -1.445812, 0.781486, -0.079563, -0.668423, 0.034928, -0.623769, 0.654019};
// float feats72[] = {-0.861837, 0.379089, -0.550015, 0.131772, -0.230380, -0.446277, -0.388844, -1.030144, 2.064630, 0.412100, -1.136123, 0.303388, -1.006710, 1.100789, 2.199150, -0.809562, 0.527476, 0.025699, 0.568272, -0.745850, -0.238857, -1.180855, 1.046845, -1.941749, -1.832123, 1.014836, 0.411945, 0.725295, -0.037742, -1.195562};
// float feats73[] = {-0.825481, -0.397149, -0.495653, 0.549712, 0.260127, 0.982934, -0.762746, -1.631898, 0.185921, -1.229560, 0.061439, 1.218880, -0.960330, -0.863426, 0.360102, -0.090169, 1.756012, 2.412982, -1.412806, 1.303081, 0.050367, 0.005029, 0.982473, 0.465093, -0.175826, -0.607657, 0.898667, 2.044491, 0.017999, -1.960601};
// float feats74[] = {-1.513778, -0.037228, -0.228352, -0.589176, -0.350502, -0.657654, -0.796880, 0.818464, -0.630311, 0.280755, -0.830200, 2.013629, -1.236902, 1.305940, 1.365319, -0.596478, 1.705746, -0.174019, -0.114810, -1.519521, 0.040428, -1.266957, 0.293167, -0.837691, 0.160610, -0.865730, -1.560388, -1.092405, -0.052382, 1.447756};
// float feats75[] = {-0.315504, 0.872052, -0.159556, 1.443986, -0.189263, 0.632793, -0.148540, -0.213087, 2.218379, -0.291320, -0.144690, 0.427760, -1.552814, -0.291259, -0.437314, -1.403683, -0.933382, -1.225287, 0.619146, 0.209968, 0.097507, 1.120861, 0.718838, 0.356139, 0.002335, -1.256741, -0.082771, 0.903954, 0.898122, 0.084795};
// float feats76[] = {1.230494, -0.146976, 0.093821, -1.110024, 0.985746, -0.382222, 0.165881, -0.527938, -0.067401, -0.295063, -0.484897, 1.975850, -1.223812, -2.231750, 0.735828, -0.633408, -0.969031, 1.557139, -0.272245, 0.583104, 0.127298, -1.195284, 0.898755, 1.074762, -0.251787, 0.231845, 1.783842, -1.861891, -0.977879, 0.963095};
// float feats77[] = {1.458821, 1.259230, 0.951807, 0.193585, 0.475827, 0.037920, -0.869265, -0.753049, 0.125892, 1.309997, 1.440845, -0.173209, -1.598371, -0.015137, -0.433621, -0.874436, -0.386337, -0.864623, -0.052012, 0.051409, -0.722246, 0.755249, 0.635188, -2.289085, 0.868786, 0.057509, 0.737552, 0.068126, 0.306119, -1.035784};
// float feats78[] = {0.418616, 0.181402, -1.075858, 0.399428, 1.189287, 0.966151, -0.932978, 1.897858, -1.262535, -2.871660, -1.434917, -0.320240, -0.020557, -0.213198, -1.136568, 0.076999, -0.028213, -1.260937, -0.372298, -0.092515, 0.434374, -1.059951, 0.575772, 0.557025, 0.970147, 1.461215, 1.211497, -0.143161, -0.058445, -0.650657};
// float feats79[] = {-0.398728, 0.670195, 1.918347, 0.695442, 0.984547, 0.916448, 0.699523, -0.294261, -0.479853, 0.250331, -0.311150, 0.535788, -0.832109, 0.136780, 1.276080, 0.393275, 1.800946, -0.313976, 0.483456, 0.252604, 0.555959, 1.114688, 0.372942, 2.411536, 2.042147, 0.317946, -0.826050, 0.035667, 1.566843, 0.185045};
// float feats80[] = {0.493325, -0.288384, -0.703309, -1.577788, 0.672457, -0.489886, 1.499530, -0.148609, 0.216561, -0.411040, 0.894983, -0.834264, -1.656976, -0.114162, -0.168730, -0.323100, -0.494994, -1.278374, 0.262269, -1.735666, -0.462496, 0.038478, 1.180475, -0.674134, 1.097890, -0.515342, 0.164528, 1.595941, -1.258934, -0.744539};
// float feats81[] = {0.740682, -0.885762, 1.238323, -1.083577, 0.803301, 0.975470, -0.056048, 1.873789, -0.145626, 0.360901, -1.514887, -0.284899, 0.571127, 0.267904, -1.071171, 0.841655, 0.149669, 1.109863, 0.067323, -0.847336, -1.098585, -0.605999, -2.146019, -0.619213, 0.893820, -0.627201, -0.893971, -1.460537, -0.919193, 0.096624};
// float feats82[] = {0.926610, -0.752773, -1.680327, 0.429299, -1.771727, -0.161527, -0.552750, 0.347704, 1.032106, -0.636893, -0.206569, -0.077019, -0.587660, 0.430134, -1.019166, -0.788573, 0.246113, -0.695224, -0.289410, -0.664903, 1.478296, -2.011322, 0.896968, 0.667602, 0.411928, 1.478655, 0.072665, -1.456549, 0.979378, -1.237337};
// float feats83[] = {1.051143, -0.731347, 1.471423, 0.510956, -0.278021, 0.242803, 0.402353, -1.048611, -0.067654, -1.299231, 0.778559, 0.663596, 0.177058, 0.448020, -1.326917, -1.479389, -0.955672, -0.162005, -0.314594, 2.359510, 0.370601, 1.401560, 0.786072, 0.748859, 0.150993, 0.050408, 0.541604, -0.092942, 0.047428, 0.324490};
// float feats84[] = {0.836150, -0.305168, 0.283803, 1.653074, 0.252819, 1.023430, -0.819444, -1.695406, -1.361747, 1.271522, -1.436442, 0.403821, -0.520536, 1.245062, -0.064802, -2.537138, -1.727218, -1.230721, 0.915686, 0.087668, 1.866912, -0.641330, 1.551048, -0.716568, -1.301823, 0.878542, 2.974346, 1.405791, 0.279487, 0.419594};
// float feats85[] = {-1.738790, 0.509424, -0.923407, -0.254838, -1.456018, -0.581945, 0.876208, 1.000999, -0.960639, -0.122268, 1.868811, 1.043143, -0.502293, -0.752507, 0.818845, -2.541231, -0.683110, -1.391315, 0.837308, 0.685037, 0.286744, 1.097770, 1.330616, 0.053997, 1.349938, 0.449366, -1.434800, -0.665026, 0.315442, 0.436422};
// float feats86[] = {-0.654449, -0.645919, -0.571859, -0.302094, 0.056257, -0.458546, -0.346627, -0.958083, 0.072705, 0.437024, 0.979798, 0.364773, 0.134718, -1.835922, -0.210745, 0.004046, 1.572949, -0.329298, -0.956698, -1.119991, -0.990354, -0.624584, -0.067933, -0.527797, 0.981182, -0.391450, -0.899421, -1.802754, 0.040062, 1.003118};
// float feats87[] = {1.704064, -0.743571, 0.164098, -0.415195, 0.878550, 0.681922, -1.548263, 0.102223, 1.266966, 0.683009, -0.671172, 0.101543, 1.076985, -0.642818, -1.078699, 1.916426, -0.343326, 0.345856, 0.536703, -3.293111, 0.309731, 1.551983, 0.591214, -0.569017, -0.426315, 0.545867, -0.795534, 1.759114, 1.342301, -0.507995};
// float feats88[] = {-1.346593, 0.936361, 1.464149, 0.071979, -0.985558, 0.824883, -0.074196, -1.043498, 0.312647, -0.379055, -0.187779, -0.398620, -1.016948, 0.743161, 0.873665, -0.527039, -1.859204, 1.903595, -0.764476, 0.684104, 0.785946, 1.520484, 1.208285, 0.838677, 0.123976, 0.630933, 0.151852, -0.495401, 0.457635, -0.082285};
// float feats89[] = {-1.128115, -0.479383, -0.520891, 0.719788, 1.604724, 0.479109, -0.619516, -0.112150, 0.201402, -0.344989, 0.351887, -0.366900, 1.037542, -0.475103, 0.443214, 0.286928, 1.450090, -2.215204, -1.086969, -0.341498, -0.945611, 1.474744, -0.677655, 0.584537, -1.371506, -1.093146, 1.549521, -0.647780, 1.051957, -0.373926};
// float feats90[] = {-1.143992, -1.096249, -0.027829, -0.628924, 1.002767, -1.667609, -1.747013, 0.487526, 0.073275, -0.131410, -0.689326, 0.775527, -1.674682, 0.157942, 0.259543, -0.342688, 0.054655, 0.311954, 0.162113, 0.021292, 0.325998, 1.132755, 1.768130, 0.194099, -0.919788, -0.295044, 1.548404, 0.910229, 1.730863, 0.227858};
// float feats91[] = {0.246200, -0.244528, 1.685400, 2.261509, -1.205533, 1.578547, -1.293876, -0.631286, 0.249121, 0.159385, -0.084397, -0.420645, -1.082536, -0.759858, 0.735678, -0.345577, 1.293727, 0.066189, -0.060913, -0.593503, -0.442006, -0.126051, 0.784965, 1.883492, -0.500643, -0.142353, 1.297841, 1.090193, -0.189157, 0.345536};
// float feats92[] = {-0.609335, -0.514007, 0.699532, -0.031856, -0.389450, 0.732728, -0.963189, -0.718971, 2.739156, 0.146373, 0.649418, 1.096165, 0.473491, 0.122799, 0.087462, -1.424833, -0.832852, 1.531744, 1.159214, 1.898726, 0.138945, -0.646276, 0.516104, 0.280635, -0.975504, -0.127751, 0.851816, 1.498861, -0.693115, 0.789867};
// float feats93[] = {0.279394, 0.127163, -0.777231, -0.085966, -0.032984, -0.453017, 1.387408, 0.422456, -0.167850, 0.696689, -0.862321, -0.376663, 0.412919, -0.330727, 1.113793, -0.887576, -0.291634, 2.581805, 1.842783, -0.689088, 0.297415, -0.016886, -0.994570, -0.603532, -2.037459, -2.297148, -0.384794, 0.997084, 0.137384, 0.754631};
// float feats94[] = {-1.326255, 0.475797, 1.332006, 0.086290, -0.385514, 0.434920, -0.805235, 0.444103, 1.340887, -0.426407, 0.820933, 0.313470, -0.982798, -1.037032, 0.648845, -0.491962, -1.861058, -1.611938, 0.779835, 0.736355, 0.049422, 1.655234, -0.264455, 0.859996, 0.162960, 0.495868, 1.005952, -0.834994, -1.324950, 0.203014};
// float feats95[] = {0.205426, 0.314692, 0.527228, 0.527130, 0.400693, -0.351729, 0.919318, -1.864649, 0.100299, 0.154972, 0.699392, 0.021111, -0.603892, 1.214341, 1.910789, -0.072903, -1.090464, 1.160859, 0.818799, -0.452711, 0.294555, -0.870991, 0.121386, 0.292378, -0.134075, 0.355572, -0.643511, -0.787337, -0.864867, -0.711467};
// float feats96[] = {1.116176, 1.050808, -0.765822, 0.139178, -0.537502, -2.237097, -0.571479, 0.898249, -0.060894, -0.739560, 0.947909, 0.557507, -0.285660, 1.105076, 0.621928, 0.616755, -0.692995, -1.425521, -0.738349, -0.700203, -0.378368, 1.383602, 0.776891, 0.608228, 0.403577, -0.896333, -0.752813, -1.373415, 0.898390, 0.151687};
// float feats97[] = {2.447371, 0.543455, -0.194669, 0.551431, 0.573310, -0.296757, 0.538279, 1.747987, -1.176296, -0.076675, -0.884526, -1.500040, 0.228871, -0.221294, 0.190215, -1.858772, -1.467329, -2.345371, -0.519466, 0.133308, 1.922263, -0.402229, 0.205903, 1.259826, -0.116747, 0.022666, -0.106289, 0.272932, 1.127802, 0.574221};
// float feats98[] = {-0.075396, -0.750539, 2.085009, -1.965837, 0.004676, 0.737329, 0.881800, 0.205800, -0.611317, -0.854412, 0.823625, 0.288640, 1.791702, -1.518603, 1.222355, 0.517732, 1.073368, 0.623276, 1.350359, 0.449881, 0.527274, 1.469994, 0.048082, -0.933157, 1.952097, 0.607989, 1.457433, 0.533066, 1.000702, 0.994649};
// float feats99[] = {-0.614941, 0.965812, 0.980945, 0.049990, -0.976122, 0.268273, 0.776173, 0.943055, 0.857542, 1.224938, -0.867766, 1.190571, 1.532734, 0.229192, -0.440120, 0.511333, -0.073525, -0.794313, 0.563191, -0.744803, -0.427042, -1.263162, -1.153564, 0.603915, 0.303683, 1.582843, 1.549056, 1.037426, -0.428652, 0.602537};
// float feats100[] = {-0.266680, -0.249826, 1.193076, -0.798972, 0.348114, -1.128922, -0.122895, -0.966720, 1.622513, 0.783143, 1.011320, -0.547292, 1.020801, -0.463130, 0.272134, -0.928623, 0.342439, -0.590435, 0.925203, 1.405995, -0.054900, 0.149051, 1.743778, 0.095520, -0.731361, 0.802618, 0.254295, 0.215906, 0.899975, 1.204878};


//25
// float feats1[] = {1.045475, 1.558323, -0.378157, 0.431730, 1.523136, 2.478041, -0.528372, 0.923000, 0.087233, 0.497231, -0.389693, 1.273962, -0.916692, 0.508610, 1.130468, -0.622034, -1.436208, -1.327154, 0.481001, 1.602118, -2.535646, -0.106315, -0.197936, -0.647344, 0.754496, };
// float feats2[] = {-1.073226, 1.195811, 1.038126, 0.215679, -1.285151, 0.710919, -1.047455, 0.025188, -0.249855, 1.178430, -1.528154, 0.759257, 0.770601, 0.381037, 0.315047, 0.136835, 1.085871, 0.450129, -2.368598, 0.751311, 1.182550, -0.201728, -0.498337, 0.597158, -0.882788, };
// float feats3[] = {1.303193, -0.506239, -0.295215, -1.227791, 3.169268, 1.025653, -0.058240, 0.136130, -0.290448, 0.381011, -0.397671, -0.079618, -0.275441, 0.269815, -0.122072, -1.113989, -0.453744, -0.215008, 0.348762, 0.563648, 1.226773, -0.120098, 0.407349, -0.726289, 1.400704, };
// float feats4[] = {-0.655953, 0.313070, -1.748821, -0.676758, -1.125742, 0.497428, 1.803801, 0.235774, 1.576310, -0.771856, -2.121330, -0.559549, -1.695163, -1.533648, -0.261328, 0.297886, -0.909343, -1.472655, 0.665251, -1.052022, 1.661939, 0.806317, 0.086420, 0.409944, -0.297965, };
// float feats5[] = {2.087741, -0.263315, -0.152821, -0.841444, -0.781998, -0.101841, -0.629504, 0.157538, 0.308078, 1.023473, 1.199330, 2.136724, -1.749642, 1.203790, -0.610830, -0.411829, -0.490774, 0.073176, -0.067725, -1.286602, 1.240041, 0.533956, 0.432277, -0.038995, -0.508849, };
// float feats6[] = {-1.034942, 0.208132, -0.327991, -0.067287, -0.091060, 0.258262, 1.643207, 2.840797, -0.310333, 0.711094, -1.392845, 2.043514, 0.182407, -0.171657, 0.122690, -1.739725, -1.318046, -1.000340, -0.265695, 0.537028, 0.269482, -0.078189, 4.229977, 0.089240, -2.150075, };
// float feats7[] = {-0.221519, -0.334998, -0.286190, -0.477080, 0.108268, 0.330718, 0.685562, -0.466088, -0.325799, -2.490381, 1.577092, -0.914017, -1.061068, 0.925642, -0.493799, -1.128515, 1.402155, 0.960273, 1.566685, 0.318093, 1.123925, -0.245291, 0.110918, 0.658759, -1.821918, };
// float feats8[] = {-0.584426, 0.691245, 0.480605, -0.540660, -1.697700, -0.588561, -1.423049, -1.653117, 1.607741, 0.012273, 1.226966, 0.022863, -0.591986, 2.682910, 0.361176, 0.624174, 0.017008, -0.453501, 0.491676, 0.715154, 0.774406, -0.297625, -0.274984, -1.238605, 0.417431, };
// float feats9[] = {-0.776132, -0.715250, -0.202922, -0.108502, 0.516580, 0.181527, -1.356713, 1.120285, 3.389567, -0.133183, -0.116341, -0.262275, -0.147392, -0.511129, -1.343123, -0.860198, 0.643697, -0.645198, 1.042313, -0.523211, -0.466650, 0.128486, 0.349525, -0.359394, 0.739327, };
// float feats10[] = {-0.974979, -0.493671, 0.489176, -0.676827, -0.134261, 0.304835, -1.227506, -0.776498, 0.740138, -0.699237, -0.569510, 1.395051, 1.885637, 0.434379, -0.880194, -0.633406, -0.774547, -1.360951, 0.431577, 1.010699, -0.110594, -0.540676, 1.018812, 1.066322, 1.072615, };
// float feats11[] = {-0.558265, 2.616843, -0.598934, 0.427811, -1.125527, 1.856876, 0.083307, -0.636377, -0.766827, 0.585587, 0.016553, -0.405782, -0.916290, -0.192914, -0.908752, 1.896217, 0.680784, 1.734726, -0.962299, -1.882437, -0.908438, 0.248939, -0.167435, 0.078693, 0.542440, };
// float feats12[] = {0.499198, 1.498754, 0.799668, 0.654030, 1.341411, -2.191206, -0.727515, 1.105218, -1.132327, 0.558783, -0.043938, -0.836454, -0.638391, -1.353865, -2.395066, 0.344653, -0.478108, 0.183686, 0.191260, 1.463168, 0.350913, 0.063890, -0.697291, 0.436028, 0.783482, };
// float feats13[] = {-0.535765, 0.095676, -0.427102, 0.108226, 0.675845, -1.332764, -1.476804, -0.412815, 0.573028, -1.185735, -1.182005, 0.681999, 1.110349, 1.442791, -0.962336, 0.289166, -0.381284, 0.721832, 1.793496, -0.758760, 0.399728, -0.188769, -0.038043, 0.211281, -0.038113, };
// float feats14[] = {0.598084, 0.649822, 0.977984, 0.219328, 0.037009, 0.110373, 1.704265, -0.384488, 2.209153, 0.748035, 0.859497, 0.208453, -0.612510, -1.076259, -0.774792, 1.151021, 1.744632, -0.202446, 2.421024, -0.664811, 0.309245, -0.131953, 0.043377, -0.597417, -0.107857, };
// float feats15[] = {1.429108, -2.106071, -1.362378, 0.677992, -0.261584, 1.844294, 1.195244, 2.145801, -0.009854, 0.134455, -0.220980, 0.618074, 0.900853, 1.117058, 0.566895, -0.922606, -0.134623, 1.341730, 0.999626, 0.312571, 2.298625, -0.322726, 0.548781, 0.113779, -0.287431, };
// float feats16[] = {-1.901800, 1.083492, -0.186977, -1.569106, 0.568433, -0.085540, 2.010883, 0.962982, -2.831386, -1.046394, -0.682877, 0.726921, 1.197375, 0.177912, 1.047059, 0.937448, -1.144153, 0.864750, 0.719860, 0.826476, 0.506161, 0.149212, 1.057948, -0.344348, -0.742098, };
// float feats17[] = {-0.647375, 0.558021, 0.339798, 0.801362, 0.086865, 0.234353, 0.668471, -1.637573, 0.651720, -0.620310, -1.899590, -2.766519, 0.417830, 0.991055, -0.361333, -0.346192, 0.375944, 0.053775, 2.252325, 0.740035, -0.381409, 0.208107, 0.274288, -0.727576, 0.308106, };
// float feats18[] = {0.163754, -1.227248, -0.943594, 1.460246, -1.162462, 0.755060, -0.128379, 0.063804, 0.006604, 1.502354, -0.739374, 0.700611, 0.322643, -0.604672, 1.018891, -0.075789, -0.059741, 0.558979, 0.724618, -0.842844, -0.585219, -1.334745, -0.672679, 0.652630, -1.452346, };
// float feats19[] = {-1.343787, 2.261260, 0.792558, 1.919293, 0.472443, 1.263398, -0.648920, 0.114378, -0.928013, -0.866171, 0.152963, 0.101818, 1.317037, -0.926380, -0.288883, -0.723658, -0.237584, -1.105669, -1.606387, -0.129942, -0.867274, 0.614092, 0.972355, -1.582967, 2.428859, };
// float feats20[] = {-0.007919, 0.450231, -0.241193, -0.418781, -1.024361, 2.635906, 0.419803, 0.858239, -1.809661, 1.773077, -1.033280, 1.883632, 0.495055, 1.913115, -0.410172, 0.440885, 0.121862, 2.247023, 0.457368, 1.253842, -0.803770, -1.805847, 0.486983, 0.456385, -0.873610, };
// float feats21[] = {0.477741, -1.138477, 0.152416, 0.318094, 0.194353, 2.413194, 2.575732, -0.334428, 1.476647, 0.896553, 0.943479, -0.332823, 0.600619, -1.792358, 1.152055, 1.007625, 1.433254, 1.204056, 1.454717, 1.410978, -0.551213, -0.997623, -0.273571, 0.891953, 1.172970, };
// float feats22[] = {-0.345977, -1.207858, -2.203528, 0.547748, -2.039615, -0.260770, -2.015766, -1.086328, -2.503497, -2.478176, 0.257910, -0.373572, -1.091580, -0.546226, -0.005580, -0.210082, -0.596967, -0.326088, -0.084899, -0.238257, 0.802986, 0.727008, 0.423051, 0.720984, -0.918208, };
// float feats23[] = {0.615800, -0.094211, -0.476377, 2.693461, 1.418017, 0.651867, 0.260483, -0.720194, 0.201988, -0.080203, -1.033098, 0.272751, -1.247796, 0.418727, 0.231412, -0.175491, 0.328268, 0.068796, -1.911784, -1.970064, 0.140246, -0.486180, -1.395882, 0.474699, -0.758969, };
// float feats24[] = {-0.359895, 0.678356, 0.355091, -0.838085, -0.086000, 0.592951, -0.123766, -0.610481, 0.109139, 1.275616, 0.276433, 0.459015, -1.605158, 0.498472, -0.921395, 0.396582, -1.029288, -1.622108, -0.238202, -0.199467, 0.159347, -0.548544, -1.416054, -0.750102, -0.372260, };
// float feats25[] = {1.307028, -0.639662, -1.515357, -0.223265, -0.643233, -0.085052, 0.787290, 1.398974, 1.187291, -1.497543, -0.230231, -0.325927, -0.095712, -0.564366, 2.736180, -1.540755, 2.715448, 1.193196, 1.132152, 0.049704, 1.666334, -1.129152, 0.599759, -0.734852, -0.046806, };
// float feats26[] = {1.360463, -1.648851, 1.498656, 1.110097, 0.321937, -1.384256, -1.345863, 1.546269, 0.973886, -0.771321, -0.975440, -1.193661, -1.399785, 0.522875, 0.930242, 1.269659, 1.000598, 1.479347, -0.318888, 1.508266, 1.243542, -0.573623, 1.135554, -0.934758, 0.461725, };
// float feats27[] = {1.366166, 0.017239, -1.342866, -2.196831, -1.240679, -1.094666, -0.396833, -0.025359, -0.604149, 0.878432, -1.170939, 1.088402, -0.858641, 0.195638, 0.117411, 0.512971, 0.003087, -0.381692, 2.127835, -0.628856, -1.116525, 1.016463, -0.375003, -0.794783, -1.163143, };
// float feats28[] = {1.114726, -1.138485, 1.263624, -0.675755, -0.280657, -1.297788, 0.198224, -0.233271, 1.311015, 1.680276, 1.540230, 0.822290, 0.458862, 2.198324, -0.786596, -1.591005, 0.185187, -1.379542, -1.591382, 0.801167, -1.467020, 1.365731, -1.037675, 0.469108, 0.640356, };
// float feats29[] = {0.796348, -1.279478, -0.827280, -1.023796, 0.646888, -1.042031, -1.914592, 0.378383, -0.967131, 0.172415, -0.128744, -0.527583, 1.747167, 1.184389, -0.256897, 0.201731, 1.809738, -0.404392, -1.858121, -0.363437, -0.068718, -0.610540, 0.570983, -0.221027, -0.534342, };
// float feats30[] = {0.204682, -0.164984, -1.406464, -0.130082, -1.133135, 1.765963, 0.130437, -0.304326, -0.515098, 1.532574, 1.497394, -1.135661, 0.066677, 1.277742, 0.399032, -0.412311, 0.929551, 0.832122, 0.225872, -0.772020, 1.413958, -0.309306, 0.260347, -0.715727, 0.776739, };
// float feats31[] = {-0.438080, 0.405534, 0.522593, -0.652844, 0.859446, 2.355895, -0.838452, -0.319988, -0.129852, -1.259704, 0.940301, 0.088513, -0.422959, 0.267107, -1.819251, -0.278488, -0.559376, 0.154790, -0.796795, 1.291016, 0.430547, -0.248250, -0.726342, 0.069154, 0.721407, };
// float feats32[] = {0.514227, -0.181488, 1.194313, 0.504329, 1.011137, -0.055863, 0.827063, -0.959731, 0.221956, -0.382576, 0.785221, 0.783719, -1.053013, -0.221269, 0.527141, 0.780625, 0.278675, -0.765159, -1.933737, 0.904865, -0.155821, -0.663316, 0.740750, 0.240071, -0.388649, };
// float feats33[] = {0.717060, 0.546126, 1.020634, 1.067618, 1.323350, 0.512814, 1.040222, 0.814479, -0.044621, 0.862953, -0.136299, -0.636168, 1.957033, 0.475375, 1.103576, 1.102131, 0.964210, -0.102359, -1.141036, -1.030146, 1.276917, -2.221063, 0.347473, -0.022664, 0.323679, };
// float feats34[] = {-0.905043, -0.581451, 1.793841, 1.560504, -0.360384, -0.928111, 1.014552, 1.399076, 0.080317, -0.398800, 1.050895, 0.511157, -0.240269, -0.031663, -0.247007, -0.157072, 0.123993, -0.461081, -1.286551, -0.412414, 0.241808, 2.085356, -0.937690, -0.703986, -0.096843, };
// float feats35[] = {-0.694266, -0.003044, 0.525098, -0.893498, 2.277742, -0.509134, -0.254737, 0.975912, 0.408686, 1.318671, 0.327259, 0.201280, 0.907908, -1.104590, -0.442115, 0.929119, 0.515056, -0.194931, -0.576041, 0.615003, 0.052712, -0.744313, -0.266852, -1.273317, 0.220964, };
// float feats36[] = {0.330023, -0.152217, -2.011474, 0.174325, -0.661345, -0.033050, -0.491740, 0.424831, -1.637594, -0.020588, 0.146282, -1.020781, -1.098037, 0.103693, -1.256605, 0.396745, 0.260534, -0.686041, 0.658264, 0.063681, 0.721996, -0.476652, -0.761497, -0.377285, -2.838409, };
// float feats37[] = {-1.591834, -0.928676, 0.550206, -1.991871, 0.897585, -0.777080, 0.084133, 0.096522, 1.198439, -0.344708, 0.074746, -0.328247, 0.748120, -0.199083, 2.225858, 0.364984, -2.454194, 1.704364, -0.476999, 0.421618, -0.777095, 0.335212, 0.475193, -0.065443, 0.586967, };
// float feats38[] = {-1.316259, -0.606417, -0.160028, -0.314083, 1.181367, 1.208092, 0.402008, 0.520788, -2.319391, -0.646368, -0.212032, -0.082750, 0.866127, 0.599534, 1.884650, 1.597141, -1.103331, -1.415997, -2.063150, -0.180223, -0.734953, -0.542413, 0.895837, 0.633187, 0.464799, };
// float feats39[] = {0.353680, 0.035490, -1.346779, -0.628493, 0.913334, -0.625116, 0.588508, -0.023251, -0.851988, 0.230060, -0.953472, 0.818728, 0.587012, 0.121199, 0.557178, 0.458352, -1.056123, 0.217169, -0.813635, -0.134367, 0.716758, -0.284123, 0.297262, -0.190276, -0.735251, };
// float feats40[] = {0.073552, 1.473428, 0.500297, 1.669660, 0.577947, 0.567922, -0.380792, 1.037272, 1.415591, 0.747679, 1.187609, -0.312260, -0.050325, 0.565212, 0.411093, -0.564154, 1.120028, -0.326319, 0.960761, -1.324135, -1.408445, -0.169295, -0.569369, 0.438887, 0.140412, };
// float feats41[] = {-0.395901, 2.056704, -0.698464, -0.525136, -0.129645, 0.524538, -1.050966, 1.065987, -0.330751, -0.559329, -1.326924, -0.515429, -3.117417, 0.459615, 0.245862, -0.491677, -0.302926, 0.463125, -1.046086, 1.466477, 0.410687, 0.944308, 0.523628, -0.437521, -0.301555, };
// float feats42[] = {-0.198887, 2.430035, 0.970929, -0.716072, -1.900834, -0.295382, 0.205319, 0.004686, -0.625164, 0.634805, -1.490130, -0.055123, -0.459586, -0.076920, 0.897959, 0.696305, -0.179678, -0.055537, -2.315400, 1.631825, -1.337550, -0.419834, 0.669325, 1.495310, 0.721831, };
// float feats43[] = {0.463583, -0.018335, -0.462481, -0.241623, 0.299353, -0.965660, 0.999769, -0.346460, 0.153286, 0.193557, 0.706385, 0.207402, -0.671293, 0.814132, 0.638277, 0.265255, 0.496363, 1.074811, 1.003507, 0.479698, -0.517529, -0.189476, -0.391492, 0.219509, 0.734015, };
// float feats44[] = {0.318236, 0.668317, -0.137005, 0.400005, -0.446605, 0.600573, 1.475499, 1.921428, -0.263261, -0.920052, -0.347990, 0.502419, -0.529236, 0.813550, -0.702542, -0.126945, -0.588444, -0.625509, -0.977788, 0.371616, -0.952982, -0.039426, 0.912696, -0.259328, 1.534523, };
// float feats45[] = {-0.347480, 1.345171, -1.172610, 0.063104, 0.176065, -1.433521, 1.487595, 1.621202, 0.811268, -1.944593, -2.264470, 1.088268, 0.625110, 0.733034, -0.800920, 0.510551, 0.442816, 0.999226, -0.766918, -1.016113, 1.192269, -0.841718, -0.557736, -1.891934, -1.306067, };
// float feats46[] = {-1.403134, -0.829725, 0.376317, 0.592246, 0.836998, -0.677980, -0.569018, -0.536317, 1.211264, 0.033502, 0.264076, -0.451263, 1.198371, -1.284948, -0.111645, -0.656281, -1.801331, -0.707254, -0.059561, -0.478338, 2.390387, -0.327892, -0.010951, 1.497426, 0.288225, };
// float feats47[] = {-0.575097, -1.241029, 0.226983, 0.043840, 0.790022, -0.702455, -0.206732, -0.272674, 1.675629, -0.224038, -0.087219, -0.134889, -0.809292, -0.105382, -0.508658, -1.042630, -1.954722, -1.410697, 0.725708, 1.732557, 0.804694, 0.610233, -0.123831, 0.564903, -0.019171, };
// float feats48[] = {0.598772, 0.877077, 2.114804, -1.110119, 1.089611, -1.427335, 0.098487, 0.875552, -0.700944, -0.323408, -0.232963, 1.203599, 0.750910, 0.585886, 0.872770, -0.271227, -1.928702, -0.706754, -0.390810, -0.964305, -1.347643, 1.722651, 1.007486, 1.084202, 0.017689, };
// float feats49[] = {-0.401014, -0.031525, 0.067148, 1.070612, 1.204151, 1.207542, 0.353123, 0.103330, -0.787959, 1.025746, 1.835608, 0.684363, -0.111475, -0.383837, -2.053624, -0.015072, -0.116089, 1.978682, -1.769738, 1.195762, 0.335812, -0.589556, -1.629586, -0.152657, -0.155164, };
// float feats50[] = {-1.003121, -0.356821, 0.529032, 0.879485, -1.708133, 0.077660, -1.232278, -1.119060, -0.227008, 0.662584, 0.847269, 0.058986, -0.192320, -2.264053, 1.329299, -3.260959, 0.773736, -1.561300, 1.923968, -0.629194, 1.814538, 0.517718, 0.128364, 0.123149, 0.026100, };
// float feats51[] = {0.478305, 0.635924, 0.061033, 0.781029, 0.212785, -0.622358, -0.255187, 0.747014, 0.502626, 0.311524, -0.641267, -1.319696, -1.726077, 0.729164, 0.867268, 1.046647, 0.894860, 0.959696, 0.028524, -0.419956, -1.759563, 0.651622, 0.321742, -0.145234, 0.517059, };
// float feats52[] = {-0.545770, -0.326484, -0.281180, 0.297982, -0.457112, 0.445116, -0.043949, -2.166546, 1.395330, 0.426152, -1.315625, 0.340793, -0.159669, -0.613628, 0.814158, -0.803471, 0.953105, 1.175010, 0.057226, 0.158195, 0.434206, 1.681035, 0.452013, -0.904450, -0.542826, };
// float feats53[] = {0.244249, 0.903019, -0.660086, -0.004390, -0.007344, -1.484563, 1.494025, -0.726122, -1.737870, -0.762254, 2.193925, 1.568200, -0.770610, 0.392699, 0.427877, -1.181502, 0.436464, 0.134574, -0.933865, -1.065692, -0.034711, -0.300167, 0.356350, 0.072668, 0.122784, };
// float feats54[] = {0.195444, 0.195901, 0.263171, 1.679854, -1.154440, -0.216619, -0.691533, -0.293326, 0.770974, 0.518910, -1.461468, 0.623226, -0.074277, 0.713071, -0.027464, 0.293622, -2.132127, -0.665948, -0.315264, -0.551008, -0.138020, 0.324342, -0.806352, -0.677443, 0.378304, };
// float feats55[] = {0.142673, 0.163903, 1.546949, -0.684865, 0.078991, 0.016757, 0.194606, -0.448874, 0.162792, 1.545940, -1.795061, -0.122688, 1.463725, 1.754817, -0.216825, -2.785916, -0.034441, -1.734690, -0.469076, -1.426315, -0.833941, -0.089881, -0.976947, 0.310481, -0.535341, };
// float feats56[] = {-0.452101, -0.277586, -0.149885, -1.111652, 1.624772, -1.377347, -0.247361, -0.313086, 0.521922, 1.484361, -0.373266, -1.325937, 2.169780, -0.305908, 1.428630, 0.029159, 0.503141, 0.041574, -0.100771, -0.053616, 0.626242, 0.106956, -1.161109, -3.012937, -0.991255, };
// float feats57[] = {-0.390263, -0.687960, -1.908788, 0.023748, 1.897498, 0.481250, -1.065902, 0.131466, 1.968393, 1.549642, -0.718485, 1.130622, -0.591265, 1.349387, 0.555643, 1.062714, -0.598523, -0.943744, 0.024992, -0.344511, 0.891595, -1.031135, 0.013040, -0.710620, -0.229977, };
// float feats58[] = {-0.464856, 0.214507, -0.602286, 1.731179, -0.927739, 2.155589, -0.556643, -0.152571, -0.300292, -0.433836, -1.385963, -0.879011, -0.581015, -0.168330, -0.506423, -1.007569, -0.211191, 0.200329, -0.832140, -2.110027, 0.380654, 0.286927, -0.984433, -1.716022, 1.354738, };
// float feats59[] = {0.270321, -0.085269, -1.032516, -0.881185, 1.665702, -0.659583, -1.872339, 0.030687, -0.732743, 0.356902, -0.066861, 0.805014, -1.325806, 0.596535, 0.777948, -0.000870, 0.882312, 0.113361, -0.191452, 0.099464, 0.105068, 0.344327, -0.465765, -1.501226, -2.391190, };
// float feats60[] = {-0.820825, 1.215148, 0.330708, 0.086384, -0.987231, 0.563797, 1.859224, -0.240338, 0.404565, -0.623843, -0.432847, 0.394420, -2.075901, -1.231739, -2.139361, 0.508916, -0.494559, -0.755765, -0.615006, -0.192700, -0.796910, 0.474981, 1.265776, -0.545697, -0.033772, };
// float feats61[] = {-0.324237, -0.799678, 1.520690, 0.154960, 0.303820, -1.096769, -1.133137, -1.070929, 1.330921, 0.258338, 0.734335, 0.320458, 1.049844, -0.469122, -1.375714, 0.524273, 0.433233, -0.554466, 0.334388, -1.180428, -1.415977, 0.105866, -1.809353, 0.273175, -1.268023, };
// float feats62[] = {-1.380310, -1.392188, -1.484760, 0.368361, 0.338072, -0.795472, -0.525185, 0.362468, 0.494012, 0.199654, 0.270943, -1.175513, -0.972895, 1.173482, 1.175722, -1.113368, -0.437902, -0.019200, 0.841476, 0.964495, -0.497911, -1.667884, 0.020087, -0.397050, -0.305797, };
// float feats63[] = {-0.755100, -1.178047, 0.042041, 0.382477, 1.587894, 0.916303, -0.770899, -0.309274, 1.395227, -0.583595, -0.342311, -1.187667, 0.227980, -1.135534, 1.313549, -0.636208, -0.154697, -0.211109, -0.570245, -0.016555, -0.664784, 0.611953, -0.225518, -1.372606, 2.075053, };
// float feats64[] = {0.302368, -0.777830, -1.231816, -0.844447, -0.178337, 0.353670, 1.378122, -0.527273, -0.402459, -1.159850, 0.702489, -0.691069, 0.765438, 0.778532, 1.083833, -0.661903, -2.019360, 1.069263, 1.239692, -0.975865, 1.569910, 1.764682, 0.392239, 1.273510, 0.283971, };
// float feats65[] = {-0.273426, -0.795795, -0.554695, 0.245487, 1.371428, -1.108773, -0.152008, -1.623752, -0.685471, -0.000904, -1.552389, 1.321787, 1.234218, -0.643468, -0.718222, -1.030144, 1.997151, -0.225812, 0.122062, -0.324628, -0.210885, 0.459270, -0.495128, -0.941406, 1.137153, };
// float feats66[] = {-0.470791, 1.135336, 0.140933, 0.257362, 0.603516, 0.942906, 0.950682, 0.669897, 0.798483, 0.803820, 2.974367, 1.061305, 0.603766, 0.507549, -0.941492, 0.736158, 1.218331, -0.396766, -0.680885, -0.162305, -1.934577, 0.101434, 0.711362, -0.931342, 1.960810, };
// float feats67[] = {0.802609, -1.072550, 0.285679, -1.457721, -0.674407, 0.338455, 0.417903, -0.204868, -0.933542, 2.028432, 1.160146, -0.933446, 0.914353, -2.146189, -0.703247, -0.595946, 0.347963, 0.749521, 0.014926, -0.746252, 0.469271, -0.454408, -0.524591, 0.271554, 0.378135, };
// float feats68[] = {-0.106124, -0.658919, 0.559565, -0.455526, 1.368885, 1.791970, -0.438906, 0.677189, -0.386465, 0.673757, -0.808792, -0.586894, -1.332211, -0.388612, -0.393140, 1.028776, 1.493005, -2.189066, -1.770168, -0.029882, 0.510791, 1.240629, 0.586144, 2.264486, -2.327666, };
// float feats69[] = {0.652742, -0.115917, 0.444156, -0.870082, -0.805040, 1.294544, -0.442671, 0.824266, -0.742278, -1.601078, 0.415174, -0.380620, -0.891039, -0.084709, -0.368170, -1.789378, 1.234657, -1.467588, -1.196361, -0.679598, 1.454589, -0.602845, -1.110905, 0.796475, 0.984254, };
// float feats70[] = {-1.411495, -0.101627, -0.206335, 0.574240, 0.497721, 0.765268, 1.078091, 0.804676, 1.445766, 1.205762, -2.288679, 0.485081, 0.115992, -0.417961, 0.605671, 2.097231, 0.070915, -0.048453, -1.430299, 1.088939, -1.118716, -0.457829, -0.099710, 1.184931, 0.818114, };
// float feats71[] = {0.761252, 0.067071, 0.073494, -0.328024, 0.136591, 1.136728, -0.778465, -0.143105, -0.769862, -1.311043, 0.830064, -1.108229, 0.009270, 0.971264, -0.297217, 0.844250, 0.830597, -0.873703, 1.644971, 3.532288, 2.099007, 0.675488, -1.374200, 0.439776, 1.732601, };
// float feats72[] = {0.175044, 0.678349, 0.744368, 0.086314, 0.269313, -0.062216, 0.822234, -0.644641, 0.598707, -0.648703, 0.055703, 1.031210, 1.105909, -0.410726, 0.191351, -0.051944, 0.334959, -0.489215, -0.540083, -0.030632, 0.697992, 0.529223, 0.269320, -0.043195, -0.685387, };
// float feats73[] = {0.193506, 1.087258, -0.661536, 0.895585, -1.008837, -0.218426, 0.834671, 1.288677, -0.446058, 0.383156, -0.337631, 0.127518, 1.027062, 1.119620, 1.530287, -1.186630, -0.318966, 0.827136, -0.892471, -1.680045, -1.901325, -1.054395, -0.793444, 0.337882, -1.984583, };
// float feats74[] = {-0.174705, 1.167546, 1.760924, 0.594152, 1.645961, 0.309175, 1.722179, -0.681770, -0.842204, 0.615255, 0.211831, -0.771991, 1.670133, 2.868393, -1.238280, 0.402908, 0.080733, 0.194004, 0.093269, -0.129940, 0.180288, 0.764132, 1.803082, -0.078171, -1.277718, };
// float feats75[] = {0.064156, -0.787223, -1.054301, 0.886276, 0.694948, -1.753491, -0.908869, -2.339772, 2.802047, -0.854810, -0.438882, -1.331930, 0.653221, -0.239356, 0.174437, -0.268595, -0.594606, 1.517970, -1.372976, -2.005791, 1.356203, 2.552917, -0.307571, -0.482658, -0.478352, };
// float feats76[] = {-0.054270, -0.567098, 0.901441, -0.592181, -0.013045, 0.928165, 0.086085, 1.215176, -2.312234, -0.933466, -1.166298, -0.707356, -0.859798, 0.624553, -0.121383, -2.205886, -0.907735, 0.398310, -0.110923, 0.456801, -0.418832, 0.464181, 0.324483, 0.062940, 1.094794, };
// float feats77[] = {-0.813006, 0.401136, 0.145383, -0.299947, 0.053484, -1.626963, -1.219578, 0.665908, 0.570725, -0.446307, 0.326498, -0.650912, 0.826375, -0.805102, 0.408672, 0.303237, 0.203280, 2.073532, 1.564796, -0.832193, 1.512707, -1.870176, -0.587386, 1.161398, -1.370348, };
// float feats78[] = {-0.449976, -1.316935, 0.876779, 0.562848, -1.640408, -1.046433, -0.043987, -1.070569, 0.132263, -0.781144, -1.496385, 0.099854, 0.371468, 0.311745, -0.465698, -0.972739, 1.526975, -0.497484, 0.287178, -0.198189, 0.369709, -0.315175, 1.231852, -0.234871, -2.377279, };
// float feats79[] = {0.035463, -0.316639, 0.672906, -0.862310, 0.575368, 0.300467, 0.363293, 0.448867, -0.192947, 0.583662, 0.695096, 0.710526, -1.530382, 0.945603, -0.051097, 1.789332, 0.646104, -1.293779, 0.372453, -0.049184, 0.434813, 0.434784, -0.923404, 0.346727, 1.123201, };
// float feats80[] = {0.183537, -0.929958, 0.469923, -0.324939, 0.278739, 0.324503, 0.565156, 0.251492, -0.869098, 0.193252, 0.326978, -2.114101, -0.717345, -0.791725, -0.046739, -0.962901, 0.631754, -0.675914, -1.853487, 2.342062, 0.958567, 1.846172, 1.734011, 0.223642, 1.211232, };
// float feats81[] = {-0.085449, -0.007909, 0.248431, 1.484337, 0.917385, 0.215019, 0.361685, 0.238840, 0.802470, 1.097453, 0.292959, -0.046479, 1.059446, -0.332482, 0.849616, 0.184876, 0.669483, -0.567977, 2.121790, 0.473894, 0.741391, 1.101276, -0.593254, -0.784875, 1.679252, };
// float feats82[] = {-0.725430, 0.331833, 0.796887, -1.156650, -0.781615, -1.605268, -0.691120, -0.787500, 0.227182, 0.162683, -0.069560, -0.093339, 0.845857, -0.702281, 1.205682, -1.207487, 1.078666, 0.016254, -0.965509, -1.682230, 0.390143, 0.451626, -0.943696, 1.012157, 0.464977, };
// float feats83[] = {0.737996, -0.006621, 0.972961, -0.644574, -0.481123, 1.215050, 1.434336, 1.035699, -1.045976, -0.893704, -1.901601, 1.118661, -2.667931, -0.157644, -0.301358, -0.624019, 1.371769, 1.612810, -0.666997, -0.953227, -0.580118, 0.603826, -0.371046, -0.799598, -0.399962, };
// float feats84[] = {-0.160971, -0.869421, -0.173358, -1.394440, -1.620439, -0.188445, 1.177241, 1.281132, -0.042393, -0.075174, -0.763788, 0.327317, -0.372766, -0.850143, 1.242673, 0.667727, -0.281640, 0.924928, 0.276961, 1.163045, -1.021104, 1.042429, -0.980634, 1.155061, 0.926565, };
// float feats85[] = {-1.588500, 0.105048, -1.334887, 0.435285, -0.426776, -0.669448, -0.614165, 0.905801, -0.842642, -0.841815, 1.731531, 0.860828, 0.164781, -0.187015, 1.449703, -0.454931, -0.337524, -1.339088, -0.748388, 0.718957, 1.039497, 0.073892, -1.429598, 0.203716, -0.004201, };
// float feats86[] = {-0.383102, 0.327624, -0.201661, -0.160617, 1.351693, -1.563116, -0.087028, -2.523202, 0.343803, 1.138620, -0.858558, -1.086207, 0.204510, 1.099891, -0.704747, 0.546975, -1.190617, 0.639030, 1.255397, 0.727454, -1.663904, 0.432750, -0.872149, -0.700277, -1.087754, };
// float feats87[] = {0.231280, 0.163592, 2.292090, 0.667850, 0.296318, -0.389732, 0.240201, -0.545561, -0.263618, -0.924939, 0.020501, -0.500315, -2.028857, 0.446888, 1.330717, 0.308096, 0.211255, 0.062089, 1.346834, -1.726806, -0.408682, 0.859624, 0.616309, -0.127419, 1.265708, };
// float feats88[] = {-1.325442, 0.791352, -0.712371, 0.221527, 0.020963, 1.202607, 1.948842, -0.411398, -1.281548, -1.165887, -1.133736, 1.196010, -1.621578, -1.626411, -0.452027, -0.002980, 0.622732, -0.574604, 0.280742, -0.226042, -1.615262, 0.526790, 0.164395, -1.338750, 0.626289, };
// float feats89[] = {0.274047, -0.199660, -0.451729, -1.633905, 1.162002, 0.105671, -0.632847, -1.080779, 0.432141, 0.232987, -0.746065, 0.925602, 1.251827, -0.590039, 1.649147, 0.654637, 1.340588, -0.086768, 1.884116, -0.353810, -1.493089, 0.752790, 0.121483, 0.680428, 0.901882, };
// float feats90[] = {0.904636, 0.426431, -0.345710, 2.351821, -1.489709, 0.598501, -1.037555, 0.383215, -0.948455, -0.146493, 0.111905, 0.794620, -1.196261, -0.470855, 0.039068, 0.439885, 0.401698, -0.166493, 0.676982, 0.307536, -0.645193, 0.325399, -0.462823, -1.780936, -1.747332, };
// float feats91[] = {-0.327202, -1.723510, 0.107118, 0.600901, -0.571793, 0.313014, 0.012220, 0.587291, -0.461758, -1.964891, -0.787794, 1.658171, 0.426009, 0.694164, 0.739341, 0.687370, -0.648290, -1.156477, 0.526303, 0.214945, 0.201215, -0.099051, 1.038136, -0.971438, -0.982259, };
// float feats92[] = {-0.720359, -2.054025, 2.205825, -0.574575, 0.613559, -0.242596, -0.967454, -0.639642, -0.415202, 0.296178, 0.683801, 0.586739, 0.358553, -0.477605, -1.083368, 1.776318, 0.334700, 0.091417, 1.484669, 0.397630, -0.020789, 1.356521, 0.096723, -0.825174, -0.114610, };
// float feats93[] = {1.379763, 0.659595, 0.270269, -0.313618, 0.768444, -0.114201, -0.315896, 0.315475, -0.770288, -1.742079, 1.936578, -1.291007, 1.527884, -0.977787, 0.245200, 0.307721, -2.090793, -1.182365, -0.282264, -1.210453, -0.138143, -0.101977, 1.211234, 0.024447, -1.201968, };
// float feats94[] = {0.324738, 0.173008, -0.041667, 0.805177, 0.618865, -1.972100, 0.814427, -1.359719, -0.273224, -1.459439, 1.184496, -0.091811, -0.457947, -1.868057, 0.346652, -0.075094, 0.387562, -1.505485, -1.191718, -1.840160, -1.364711, 1.322772, 0.466894, 1.055210, 0.690368, };
// float feats95[] = {0.678153, -0.118901, -1.319645, 0.827010, -0.950515, -1.029517, -0.959012, 0.425915, 1.369042, 2.251927, 0.316201, -0.446845, -0.214212, -0.176835, 0.883589, -0.282658, 1.368248, -1.007570, 1.133854, -1.224919, -2.069501, -0.257860, -1.182454, 1.300397, -0.538623, };
// float feats96[] = {-0.870381, -2.399182, 0.435981, 1.985059, 0.697520, 0.323028, -0.522776, -1.039820, 0.191440, 0.374707, -0.516867, 2.531287, -0.978436, 1.044203, 1.924280, -0.740105, -0.210043, 0.425854, 1.031292, 0.164985, -1.306636, -0.319366, -0.703886, 1.257625, 1.458359, };
// float feats97[] = {-0.053901, 1.510994, -0.072026, 0.561684, 0.652007, -0.331090, 0.180714, -0.850924, -1.314418, 0.214195, -1.546992, 0.270776, 1.237857, 0.073882, 0.986893, 0.907574, 1.811919, -0.264182, -0.909866, -0.071639, -1.449384, -2.196358, -1.449865, -0.715571, 1.369262, };
// float feats98[] = {0.924860, -0.250550, -0.756600, -0.239396, 0.752168, 0.471339, 2.299466, 0.677434, 1.439165, 0.441297, -0.318408, 0.544605, -1.593205, -0.167504, -0.494789, 0.010534, 0.017125, 0.516630, 0.886228, 0.915752, -1.189372, 1.105351, 0.949278, -0.724055, 0.404456, };
// float feats99[] = {1.164419, -0.910945, -1.534000, -1.064717, -0.342206, -0.044121, 0.655106, 1.263796, -1.144067, -0.988163, 0.352033, 0.532733, -0.322040, -0.319984, 0.661808, 0.159955, 0.188219, -0.414331, 0.353422, -0.632454, 0.522329, 0.062736, -0.400601, 1.463921, -0.747103, };
// float feats100[] = {0.477150, -0.783097, 0.786072, -1.136198, -0.196659, -0.091007, 1.324174, -0.552110, -0.961968, -0.614302, -0.952958, -0.195464, 1.353817, -0.710714, -1.415767, -2.051121, 1.940791, -1.671826, 0.821595, -0.689151, 0.213510, 1.179150, -0.893915, -0.008746, 1.008212, };

//****************************************************************************
// Public Function(s)
//****************************************************************************

//Call this function once in main.c, just before the while()
void init_MIT_DLeg(void)
{

}

//MIT DLeg Finite State Machine.
//Call this function in one of the main while time slots.

void MIT_DLeg_fsm_1(void)
{

	// static int status = 8;
	// static int currentStride = 0;
	// static int indicator = 0;

	#if(ACTIVE_PROJECT == PROJECT_MIT_DLEG)

    static uint32_t elapsed_samples = 0;
    static uint32_t iter = 0;
    //Increment time (1 tick = 1ms nominally; need to confirm)
    elapsed_samples++;

    //begin main FSM
	switch(fsm1State)
	{
		case STATE_POWER_ON:
			//Same power-on delay as FSM2:
			if(elapsed_samples >= AP_FSM2_POWER_ON_DELAY ) {
				fsm1State = STATE_INIT_CURRENT_CONTROLLER;
				elapsed_samples = 0;
			}

			break;

		case STATE_INIT_CURRENT_CONTROLLER:

			init_current_controller(0);		//initialize Current Controller with gains
			fsm1State = STATE_INIT_GENERAL;
			elapsed_samples = 0;

			break;

		case STATE_INIT_GENERAL:
			//sensor update happens in mainFSM2(void) in main_fsm.c
			isEnabledUpdateSensors = 1;

			
			init_user_writes();

			fsm1State = STATE_TASK_MACHINE;
			elapsed_samples = 0;

			break;

		case STATE_TASK_MACHINE:
			
// 				if (!safetyShutoff()) {
// 					act1.tauDes = biomCalcImpedance(act1.desiredJointK_f, 0, act1.desiredJointB_f, act1.desiredJointAngleDeg_f);
// //					setMotorTorque(&act1, act1.tauDes);
// 				}
				

			
			

			// if (status == 8){
			// 	indicator = 1-indicator;
			// 	reset_learning_demux();
			// 	currentStride++;
			// 	//  if (currentStride == 1001)
			// 	// // 	currentStride = 1;
			// }
			// if (currentStride == 1)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats1, 4);
			// else if (currentStride == 2)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats2, 4);
			// else if (currentStride == 3)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats3, 4);
			// else if (currentStride == 4)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats4, 4);
			// else if (currentStride == 5)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats5, 4);
			// else if (currentStride == 6)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats6, 4);
			// else if (currentStride == 7)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats7, 4);
			// else if (currentStride == 8)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats8, 4);
			// else if (currentStride == 9)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats9, 4);
			// else if (currentStride == 10)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats10, 4);
			// else if (currentStride == 11)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats11, 4);
			// else if (currentStride == 12)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats12, 4);
			// else if (currentStride == 13)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats13, 4);
			// else if (currentStride == 14)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats14, 4);
			// else if (currentStride == 15)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats15, 4);
			// else if (currentStride == 16)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats16, 4);
			// else if (currentStride == 17)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats17, 4);
			// else if (currentStride == 18)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats18, 4);
			// else if (currentStride == 19)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats19, 4);
			// else if (currentStride == 20)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats20, 4);
			// else if (currentStride == 21)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats21, 4);
			// else if (currentStride == 22)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats22, 4);
			// else if (currentStride == 23)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats23, 4);
			// else if (currentStride == 24)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats24, 4);
			// else if (currentStride == 25)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats25, 4);
			// else if (currentStride == 26)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats26, 4);
			// else if (currentStride == 27)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats27, 4);
			// else if (currentStride == 28)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats28, 4);
			// else if (currentStride == 29)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats29, 4);
			// else if (currentStride == 30)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats30, 4);
			// else if (currentStride == 31)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats31, 4);
			// else if (currentStride == 32)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats32, 4);
			// else if (currentStride == 33)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats33, 4);
			// else if (currentStride == 34)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats34, 4);
			// else if (currentStride == 35)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats35, 4);
			// else if (currentStride == 36)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats36, 4);
			// else if (currentStride == 37)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats37, 4);
			// else if (currentStride == 38)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats38, 4);
			// else if (currentStride == 39)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats39, 4);
			// else if (currentStride == 40)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats40, 4);
			// else if (currentStride == 41)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats41, 4);
			// else if (currentStride == 42)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats42, 4);
			// else if (currentStride == 43)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats43, 4);
			// else if (currentStride == 44)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats44, 4);
			// else if (currentStride == 45)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats45, 4);
			// else if (currentStride == 46)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats46, 4);
			// else if (currentStride == 47)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats47, 4);
			// else if (currentStride == 48)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats48, 4);
			// else if (currentStride == 49)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats49, 4);
			// else if (currentStride == 50)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats50, 4);
			// else if (currentStride == 51)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats51, 4);
			// else if (currentStride == 52)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats52, 4);
			// else if (currentStride == 53)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats53, 4);
			// else if (currentStride == 54)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats54, 4);
			// else if (currentStride == 55)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats55, 4);
			// else if (currentStride == 56)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats56, 4);
			// else if (currentStride == 57)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats57, 4);
			// else if (currentStride == 58)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats58, 4);
			// else if (currentStride == 59)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats59, 4);
			// else if (currentStride == 60)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats60, 4);
			// else if (currentStride == 61)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats61, 4);
			// else if (currentStride == 62)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats62, 4);
			// else if (currentStride == 63)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats63, 4);
			// else if (currentStride == 64)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats64, 4);
			// else if (currentStride == 65)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats65, 4);
			// else if (currentStride == 66)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats66, 4);
			// else if (currentStride == 67)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats67, 4);
			// else if (currentStride == 68)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats68, 4);
			// else if (currentStride == 69)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats69, 4);
			// else if (currentStride == 70)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats70, 4);
			// else if (currentStride == 71)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats71, 4);
			// else if (currentStride == 72)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats72, 4);
			// else if (currentStride == 73)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats73, 4);
			// else if (currentStride == 74)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats74, 4);
			// else if (currentStride == 75)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats75, 4);
			// else if (currentStride == 76)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats76, 4);
			// else if (currentStride == 77)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats77, 4);
			// else if (currentStride == 78)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats78, 4);
			// else if (currentStride == 79)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats79, 4);
			// else if (currentStride == 80)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats80, 4);
			// else if (currentStride == 81)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats81, 4);
			// else if (currentStride == 82)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats82, 4);
			// else if (currentStride == 83)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats83, 4);
			// else if (currentStride == 84)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats84, 4);
			// else if (currentStride == 85)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats85, 4);
			// else if (currentStride == 86)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats86, 4);
			// else if (currentStride == 87)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats87, 4);
			// else if (currentStride == 88)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats88, 4);
			// else if (currentStride == 89)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats89, 4);
			// else if (currentStride == 90)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats90, 4);
			// else if (currentStride == 91)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats91, 4);
			// else if (currentStride == 92)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats92, 4);
			// else if (currentStride == 93)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats93, 4);
			// else if (currentStride == 94)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats94, 4);
			// else if (currentStride == 95)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats95, 4);
			// else if (currentStride == 96)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats96, 4);
			// else if (currentStride == 97)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats97, 4);
			// else if (currentStride == 98)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats98, 4);
			// else if (currentStride == 99)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats99, 4);
			// else if (currentStride == 100)
			// status = learning_demux(&(tm.lrn), &(tm.lda), feats100, 4);

			

			task_machine_demux(&rigid1);

			iter++;
			if (iter > 30000)
				iter = 0;
			rigid1.mn.genVar[0] = (int16_t) (iter); //
			rigid1.mn.genVar[1] = (int16_t) (get_task_machine()->inSwing); //
			rigid1.mn.genVar[2] = (int16_t) (get_task_machine()->tq); //
			rigid1.mn.genVar[3] = (int16_t) (get_kinematics()->accNormSq*10.0); //
			rigid1.mn.genVar[4] = (int16_t) (get_kinematics()->vAz); //
			rigid1.mn.genVar[5] = (int16_t) (get_task_machine()->resetTrigger); //
			//   rigid1.mn.genVar[5] = (int16_t) (tm.lda->A[120]*1000.0); //
			//   rigid1.mn.genVar[6] = (int16_t) (tm.lda->A[121]*1000.0);//
			//   rigid1.mn.genVar[7] = (int16_t) (tm.lda->A[122]*1000.0);//
			//   rigid1.mn.genVar[8] = (int16_t) (tm.lda->A[123]*1000.0);//
		 //   	rigid1.mn.genVar[9] = (int16_t) (tm.lda->A[124]*1000.0);//

				break;



        	default:
			//Handle exceptions here
			break;
	}

	#endif	//ACTIVE_PROJECT == PROJECT_MIT_DLEG
}


// //Second state machine for the DLeg project
// void MIT_DLeg_fsm_2(void)
// {
// 	#if(ACTIVE_PROJECT == PROJECT_MIT_DLEG)

// 		//Currently unused - we use ActPack's FSM2 for comm

// 	#endif	//ACTIVE_PROJECT == PROJECT_MIT_DLEG
// }

//****************************************************************************
// Private Function(s)
//****************************************************************************
/*
 * Check for safety flags, and act on them.
 * todo: come up with correct strategies to deal with flags, include thermal limits also
 */

void init_user_writes(void) {
	user_data_1.w[0] = 0; 
	user_data_1.w[1] = 0; 
	user_data_1.w[2] = 0;
	user_data_1.w[3] = 0;	
}


int8_t safetyShutoff(void) {

	act1.commandTimer++;

	if (act1.commandTimer >= MOTOR_TIMEOUT) {
		//hold position for now.
		act1.tauDes = biomCalcImpedance(act1.desiredJointK_f, 0, act1.desiredJointB_f, act1.desiredJointAngleDeg_f);
//		setMotorTorque(&act1, act1.tauDes);
	}

	//turn off motors if there's a comm timeout with Odroid
	if (!act1.motorOnFlag) {
//		setMotorCurrent(0, 0);
		return 1;
	}


	switch(isSafetyFlag)

	{
		case SAFETY_OK:

			return 0;

		case SAFETY_ANGLE:
			//check if flag is not still active to be released, else do something about problem.
			if(!isAngleLimit) {
				isSafetyFlag = SAFETY_OK;
				break;
			} else {
				// do nothing. Clamping is handled in calcRestoringCurrent();
			}

			return 0; //continue running FSM

		case SAFETY_TORQUE:

			//check if flag is not still active to be released, else do something about problem.
			if(!isTorqueLimit) {
				isSafetyFlag = SAFETY_OK;
				break;
			} else {
				// This could cause trouble, but seems more safe than an immediate drop in torque. Instead, reduce torque.
				setMotorTorque(&act1, act1.tauDes * 0.5); // reduce desired torque by 50%
			}

			return 1;

		case SAFETY_TEMP:
			//check if flag is not still active to be released, else do something about problem.
			if( !isTempLimit ) {
				currentOpLimit = CURRENT_LIMIT_INIT;		// return to full power todo: may want to gradually increase
				isSafetyFlag = SAFETY_OK;
				break;
			} else {
				if (currentOpLimit > 0) {
					currentOpLimit--;	//reduce current limit every cycle until we cool down.
				}
			}

			return 0; //continue running FSM

		default:
			return 1;
	}


	return 0;
}

/*
 * Collect all sensor values and update the actuator structure.
 * Throws safety flags on Joint Angle, Joint Torque, since these functions look at transformed values.
 */
void updateSensorValues(struct act_s *actx)
{
	getJointAngleKinematic(actx);

	actx->jointAngleDegrees = actx->jointAngle * DEG_PER_RAD;
	actx->jointVelDegrees = actx->jointVel * DEG_PER_RAD;
	actx->linkageMomentArm = getLinkageMomentArm(actx->jointAngle);
	actx->axialForce = 0.8*actx->axialForce + 0.2*getAxialForce();

	actx->jointTorque = getJointTorque(actx);

	updateJointTorqueRate(actx);
	//actx->jointTorqueRate = windowJointTorqueRate(actx);

	actx->motorVel =  *rigid1.ex.enc_ang_vel / 16.384 * angleUnit;	// rad/s
	actx->motorAcc = rigid1.ex.mot_acc;	// rad/s/s

	actx->regTemp = rigid1.re.temp;
	actx->motTemp = 0; // REMOVED FOR NOISE ISSUES getMotorTempSensor();
	actx->motCurr = rigid1.ex.mot_current;
	actx->currentOpLimit = currentOpLimit; // throttled mA

	actx->safetyFlag = isSafetyFlag;

	if(actx->regTemp > PCB_TEMP_LIMIT_INIT || actx->motTemp > MOTOR_TEMP_LIMIT_INIT)
	{
		isSafetyFlag = SAFETY_TEMP;
		isTempLimit = 1;
	} else {
		isTempLimit = 0;
	}

	//convert values for multipacket
	actx->intJointAngleDegrees = (int16_t) (actx->jointAngleDegrees*INT_SCALING);
	actx->intJointVelDegrees = (int16_t) (actx->jointVelDegrees*INT_SCALING);
	actx->intJointTorque = (int16_t) (actx->jointTorque*INT_SCALING);

}

//The ADC reads the motor Temp sensor - MCP9700 T0-92. This function converts the result to C.
int16_t getMotorTempSensor(void)
{
	static int16_t mot_temp = 0;
	mot_temp = (rigid1.mn.analog[0] * (3.3/4096) - 500) / 10; 	//celsius
	rigid1.mn.mot_temp = mot_temp;

	return mot_temp;
}

/*
 * Output joint angle, vel, accel in ANG_UNIT, measured from joint zero,
 * Input:	joint[3] empty array reference
 * Return:	updated joint[3] array
 * 		joint[0] = angle
 * 		joint[1] = velocity
 * 		joint[2] = acceleration
 * 		todo: pass a reference to the act_s structure to set flags.
 */
//float* getJointAngleKinematic( void )
void getJointAngleKinematic(struct act_s *actx)
{
	static int32_t jointAngleCnts = 0;
	static int32_t jointAngleCntsAbsolute = 0;
	static float last_jointVel;
	static float jointAngleAbsolute = 0;

	//ANGLE
	//Configuration orientation
	jointAngleCnts = JOINT_ANGLE_DIR * ( jointZero + JOINT_ENC_DIR * (*(rigid1.ex.joint_ang)) );

	//if we start over soft limits after findPoles(), only turn on motor after getting within limits
	if (startedOverLimit && jointAngleCnts*(angleUnit)/JOINT_CPR < jointMaxSoft && jointAngleCnts*(angleUnit)/JOINT_CPR > jointMinSoft) {
		startedOverLimit = 0;
	}

	actx->jointAngle = 0.8*actx->jointAngle + 0.2*jointAngleCnts  * (angleUnit)/JOINT_CPR;

	if (actx->jointAngle > JOINT_MAX_SOFT || actx->jointAngle < JOINT_MIN_SOFT) {
		isSafetyFlag = SAFETY_ANGLE;
		isAngleLimit = 1;
	} else {
		isAngleLimit = 0;
	}

	//Absolute orientation to evaluate against soft-limits
	jointAngleCntsAbsolute = JOINT_ANGLE_DIR * ( jointZeroAbs + JOINT_ENC_DIR * (*(rigid1.ex.joint_ang)) );
	jointAngleAbsolute = jointAngleCnts  * (angleUnit)/JOINT_CPR;

	//VELOCITY
	actx->jointVel = 0.8*actx->jointVel + 0.2*(1000.0*(actx->jointAngle - actx->lastJointAngle));


	//ACCEL  -- todo: check to see if this works
	actx->jointAcc = (( actx->jointVel - last_jointVel )) * (angleUnit)/JOINT_CPR * SECONDS;

	actx->lastJointAngle = actx->jointAngle;
	//last_jointAngle = joint[0];
	//last_jointVel = joint[1];



}


// Output axial force on screw, Returns [Newtons]
float getAxialForce(void)
{
	static int8_t tareState = -1;
	static uint32_t timer = 0;
	uint16_t strainReading = 0;
	static float tareOffset = 0;
	float axialForce = 0;
	float numSamples = 100.;

	strainReading = (rigid1.ex.strain);

	switch(tareState)
	{
		case -1:
			//Tare the balance using average of numSamples readings
			timer++;

			if(timer <= numSamples) {
				strainReading = (rigid1.ex.strain);
				tareOffset += ((float) strainReading)/numSamples;
			} else {
				tareState = 0;
			}

			break;

		case 0:

			axialForce =  FORCE_DIR * (strainReading - tareOffset) * forcePerTick;
//			axialForce = windowSmoothAxial(axialForce);

			break;

		default:
			//problem occurred
			break;
	}

	return axialForce;
}

// Linear Actuator Actual Moment Arm,
// input( jointAngle, theta [rad] )
// return moment arm projected length  [m]
float getLinkageMomentArm(float theta)
{
	//static float a = 147.6787, b = 42.9535, T = 0.3239, F = 1.1384;
	static float A = 0, c = 0, r = 0, C_ang = 0;
//	theta_r = ANG_UNIT % 360 ? (theta*M_PI/180) : theta; 	// convert deg to radians if necessary.
//	theta_r = theta * M_PI / 180;	// convert deg to radians.

    // const float t = 47; 	// [mm] tibial offset
    // const float t_k = 140; 	// [mm] offset from knee along tibia
    // const float f = 39;  	// [mm] femur offset
    // const float f_k = 18;	// [mm] offset from knee along femur

    // const float aIn = t*t + t_k*t_k;
    // a = sqrt(aIn);
    // const float bIn = f*f + f_k*f_k;
    // b = sqrt(bIn);



    // const float Tin = t/t_k;
    // T = atan(Tin);
    // const float Fin = f/f_k;
    // F = atan(Fin);

	C_ang = M_PI - theta - (1.4623); 	// angle
	c = sqrtf( 21809. + 1845. - 12687.0*cosf(C_ang) );
	A = acosf( (21809. - (c*c + 1845.)) / (-85.9070*c) );
    r = 0.0429535 * sinf(A);

    //C_ang = M_PI - theta - (T + F); 	// angle
    //c = sqrt( a*a + b*b - 2*a*b*cos(C_ang) );  // length of actuator from pivot to output
    //A = acos( (a*a - (c*c + b*b)) / (-2*b*c) );
    //r = b * sin(A);

    return r;
}

/*
 *  Determine torque at joint due to moment arm and axial force
 *  input:	struct act_s
 *  return: joint torque [Nm]
 *  //todo: more accurate is to track angle of axial force. maybe at getLinkageMomentArm
 */
float getJointTorque(struct act_s *actx)
{
	float torque = 0;

	torque = actx->linkageMomentArm * actx->axialForce;

	torque = torque * TORQ_CALIB_M + TORQ_CALIB_B;		//apply calibration to torque measurement

	if(torque >= ABS_TORQUE_LIMIT_INIT || torque <= -ABS_TORQUE_LIMIT_INIT) {
		isSafetyFlag = SAFETY_TORQUE;
		isTorqueLimit = 1;
	} else {
		isTorqueLimit = 0;
	}

	return torque;
}

/*
 *  Determine torque rate at joint using window averaging
 *  input:	struct act_s
 *  return: joint torque rate [Nm/s]
 */
float windowJointTorqueRate(struct act_s *actx) {
	#define TR_WINDOW_SIZE 3

	static int8_t index = -1;
	static float window[TR_WINDOW_SIZE];
	static float average = 0;
	static float previousTorque = 0;
	float currentRate = 0;

	index = (index + 1) % TR_WINDOW_SIZE;
	currentRate = (actx->jointTorque - previousTorque)*SECONDS;
	average -= window[index]/TR_WINDOW_SIZE;
	window[index] = currentRate;
	average += window[index]/TR_WINDOW_SIZE;

	previousTorque = actx->jointTorque;

	return average;

}

void updateJointTorqueRate(struct act_s *actx){

    actx->jointTorqueRate = 0.8 * actx->jointTorqueRate + 0.2 *(1000.0*(actx->jointTorque - actx->lastJointTorque));
    actx->lastJointTorque = actx->jointTorque;
}

/*
 * Calculate required motor torque, based on joint torque
 * input:	*actx,  actuator structure reference
 * 			tor_d, 	desired torque at joint [Nm]
 * return:	set motor torque
 * 			Motor Torque request, or maybe current
 */
void setMotorTorque(struct act_s *actx, float tau_des)
{
	float N = 1;					// moment arm [m]
	float tau_meas = 0, tau_ff=0;  	//joint torque reflected to motor.
	float tau_err = 0;
	static float tau_err_last = 0, tau_err_int = 0;
	float tau_PID = 0, tau_err_dot = 0, tau_motor_comp = 0;		// motor torque signal
	int32_t dtheta_m = 0, ddtheta_m = 0;		//motor vel, accel
	int32_t I = 0;								// motor current signal

	N = actx->linkageMomentArm * nScrew;
	dtheta_m = actx->motorVel;
	ddtheta_m = actx->motorAcc;

	actx->tauDes = tau_des;				// save in case need to modify in safetyFailure()

	// todo: better fidelity may be had if we modeled N_ETA as a function of torque, long term goal, if necessary
	tau_meas =  actx->jointTorque / N;	// measured torque reflected to motor [Nm]
	tau_des = tau_des / N;				// scale output torque back to the motor [Nm].
	tau_ff = tau_des / (N_ETA) ;		// Feed forward term for desired joint torque, reflected to motor [Nm]

	tau_motor_comp = (motJ + MOT_TRANS)*ddtheta_m + motB*dtheta_m;	// compensation for motor parameters. not stable right now.

	// Error is done at the motor. todo: could be done at the joint, messes with our gains.
	tau_err = tau_des - tau_meas;
	tau_err_dot = (tau_err - tau_err_last);
	tau_err_int = tau_err_int + tau_err;
	tau_err_last = tau_err;

	//PID around motor torque
	tau_PID = tau_err*torqueKp + tau_err_dot*torqueKd + tau_err_int*torqueKi;

	if (!isAngleLimit) {
		I = 1/MOT_KT * (tau_ff + tau_PID + tau_motor_comp) * currentScalar;

	//joint velocity must not be 0 (could be symptom of joint position signal outage)
	} else if (actx->jointVel != 0 && !startedOverLimit) {
		I = calcRestoringCurrent(actx, N);
	//if we started beyond soft limits after finding poles, or joint position is out
	} else {
		I = 0;
	}

	//account for deadzone current (unused due to instability). Unsolved problem according to Russ Tedrake.
//	if (abs(dtheta_m) < 3 && I < 0) {
//		I -= motSticNeg; //in mA
//	} else if (abs(dtheta_m) < 3 && I > 0) {
//		I += motSticPos;
//	}

	//Saturate I for our current operational limits -- limit can be reduced by safetyShutoff() due to heating
	if (I > currentOpLimit)
	{
		I = currentOpLimit;
	} else if (I < -currentOpLimit)
	{
		I = -currentOpLimit;
	}

	actx->desiredCurrent = (int32_t) I; 	// demanded mA
	setMotorCurrent(actx->desiredCurrent, 0);	// send current command to comm buffer to Execute

	//variables used in cmd-rigid offset 5
	rigid1.mn.userVar[5] = tau_meas*1000;
	rigid1.mn.userVar[6] = tau_des*1000;

}

float calcRestoringCurrent(struct act_s *actx, float N) {
	//Soft angle limits with virtual spring. Raise flag for safety check.

	float angleDiff = 0;
	float tauDes = 0;
	float k = 7; // N/m
	float b = 0.3; // Ns/m

	//Oppose motion using linear spring with damping
	if (actx->jointAngleDegrees - jointMinSoftDeg < 0) {

		angleDiff = actx->jointAngleDegrees - jointMinSoftDeg;

		if (abs(angleDiff) < 2) {
			tauDes = -k*angleDiff - b*actx->jointVelDegrees + 2;
		} else {
			tauDes = -k*angleDiff - b*actx->jointVelDegrees;
		}

	} else if (actx->jointAngleDegrees - jointMaxSoftDeg > 0) {

		angleDiff = actx->jointAngleDegrees - jointMaxSoftDeg;

		if (abs(angleDiff) < 2) {
			tauDes = -k*angleDiff - b*actx->jointVelDegrees - 2;
		} else {
			tauDes = -k*angleDiff - b*actx->jointVelDegrees;
		}
	}

	return (tauDes/(N*N_ETA)) * currentScalar/MOT_KT;

}

//UNUSED. See state_machine
/*
 * Simple Biom controller
 * input:	theta_set, desired theta (degrees)
 * 			k1,k2,b, impedance parameters
 * return: 	tor_d, desired torque
 */
float biomCalcImpedance(float k1, float k2, float b, float theta_set)
{
	float theta = 0, theta_d = 0;
	float tor_d = 0;

	theta = act1.jointAngleDegrees;
	theta_d = act1.jointVelDegrees;
	tor_d = k1 * (theta_set - theta ) + k2 * powf((theta_set - theta ), 3) - b*theta_d;

	return tor_d;

}

void packRigidVars(struct act_s *actx) {

	// set float userVars to send back to Plan
	rigid1.mn.userVar[0] = actx->jointAngleDegrees*1000;
	rigid1.mn.userVar[1] = actx->jointVelDegrees*1000;
	rigid1.mn.userVar[2] = actx->linkageMomentArm*1000;
	rigid1.mn.userVar[3] = actx->axialForce*1000;
	rigid1.mn.userVar[4] = actx->jointTorque*1000;
    //userVar[5] = tauMeas
    //userVar[6] = tauDes (impedance controller - spring contribution)
}

float windowSmoothJoint(int32_t val) {
	#define JOINT_WINDOW_SIZE 5

	static int8_t index = -1;
	static float window[JOINT_WINDOW_SIZE];
	static float average = 0;


	index = (index + 1) % JOINT_WINDOW_SIZE;
	average -= window[index]/JOINT_WINDOW_SIZE;
	window[index] = (float) val;
	average += window[index]/JOINT_WINDOW_SIZE;

	return average;
}

float windowSmoothAxial(float val) {
	#define AXIAL_WINDOW_SIZE 5

	static int8_t index = -1;
	static float window[AXIAL_WINDOW_SIZE];
	static float average = 0;


	index = (index + 1) % AXIAL_WINDOW_SIZE;
	average -= window[index]/AXIAL_WINDOW_SIZE;
	window[index] = val;
	average += window[index]/AXIAL_WINDOW_SIZE;

	return average;
}


void openSpeedFSM(void)
{
	static uint32_t deltaT = 0;
	static uint8_t fsm1State = 0;

	switch(fsm1State)
	{
		case 0:
			setControlMode(CTRL_OPEN, 0);
			setMotorVoltage(0, 0);
			fsm1State = 1;
			deltaT = 0;
			break;
		case 1:
			deltaT++;
			if(deltaT > 3000)
			{
				deltaT = 0;
				fsm1State = 2;
			}
			setMotorVoltage(0, 0);
			break;
		case 2:
			deltaT++;
			if(deltaT > 3000)
			{
				deltaT = 0;
				fsm1State = 1;
			}
			setMotorVoltage(1000, 0);
			break;
	}
}

void twoPositionFSM(void)
{
	static uint32_t timer = 0, deltaT = 0;
	static int8_t fsm1State = -1;
	static int32_t initPos = 0;

	switch(fsm1State)
	{
		case -1:
			//We give FSM2 some time to refresh values
			timer++;
			if(timer > 25)
			{
				initPos = *(rigid1.ex.enc_ang);
				fsm1State = 0;
			}
			break;
		case 0:
			setControlMode(CTRL_POSITION, 0);
			setControlGains(20, 6, 0, 0, 0);	//kp = 20, ki = 6
			setMotorPosition(initPos, 0);
			fsm1State = 1;
			deltaT = 0;
			break;
		case 1:
			deltaT++;
			if(deltaT > 1000)
			{
				deltaT = 0;
				fsm1State = 2;
			}
			setMotorPosition(initPos + 10000, 0);
			break;
		case 2:
			deltaT++;
			if(deltaT > 1000)
			{
				deltaT = 0;
				fsm1State = 1;
			}
			setMotorPosition(initPos, 0);
			break;
	}
}

void twoTorqueFSM(struct act_s *actx)
{
	static uint32_t timer = 0, deltaT = 0;
	static int8_t fsm1State = -1;
	static int32_t initPos = 0;


	switch(fsm1State)
	{
		case -1:
			//We give FSM2 some time to refresh values
			timer++;
			if(timer > 25)
			{
				initPos = actx->jointAngle;
				fsm1State = 0;
			}
			break;
		case 0:
//			mit_init_current_controller();
			fsm1State = 1;
			deltaT = 0;
			break;
		case 1:
			deltaT++;
			if(deltaT > 1000)
			{
				deltaT = 0;
				fsm1State = 2;
			}
			setMotorTorque( actx, 2);
			break;
		case 2:
			deltaT++;
			if(deltaT > 1000)
			{
				deltaT = 0;
				fsm1State = 1;
			}
			setMotorTorque( actx, -2);
			break;
	}
}

void oneTorqueFSM(struct act_s *actx)
{
	static uint32_t timer = 0, deltaT = 0;
	static int8_t fsm1State = -1;
	static int32_t initPos = 0;
	static int setPt = 0;




	switch(fsm1State)
	{
		case -1:
			//We give FSM2 some time to refresh values
			timer++;
			if(timer > 25)
			{
				initPos = actx->jointAngle;
				fsm1State = 0;
			}
			break;
		case 0:
//			mit_init_current_controller();
			fsm1State = 1;
			deltaT = 0;
			break;
		case 1:
			deltaT++;
			if(deltaT > 3000)
			{
				deltaT = 0;
				fsm1State = 2;
			}

			setMotorTorque( actx, setPt);
			break;
		case 2:
			deltaT++;
			if(deltaT > 3000)
			{
				deltaT = 0;
				fsm1State = 1;
			}
			setMotorTorque( actx, 0);
			break;
	}

}


//control ankle torque by through user_data_1[2] as amplitude and user_data_1[3] as frequency
void torqueSweepTest(struct act_s *actx) {
		static int32_t timer = 0;
		static int32_t stepTimer = 0;
		static float currentFrequency = 0;

		float torqueAmp = user_data_1.w[0]/10.;
		float frequency = user_data_1.w[1]/10.;
		float frequencyEnd = user_data_1.w[2]/10.;
		float numSteps = user_data_1.w[3];

		timer++;

		// if torqueAmp is ever set to 0, reset sweep test params
		if (torqueAmp == 0) {
			stepTimer = 0;
			currentFrequency = 0;
		}

		// start check to see what type of sweep desired
		if (frequency > 0) {
			float torqueDes = 0;

			//just want to sweep at one frequency
			if (frequencyEnd == 0 || numSteps == 0) {

				torqueDes = torqueAmp * sin(frequency*timer*2*M_PI/1000);
				setMotorTorque(actx, torqueDes);

			} else {

				// 2 seconds per intermediate frequency step
				if (stepTimer <= 2*SECONDS) {

					torqueDes = torqueAmp * sin(currentFrequency*stepTimer*2*M_PI/1000);
					setMotorTorque(actx, torqueDes);

					stepTimer++;
					user_data_1.r[0] = 1; //1 if testing

				} else {

					stepTimer = 0;
					currentFrequency += (frequencyEnd-frequency)/numSteps; //increment frequency step
					//stop test
					if (currentFrequency > frequencyEnd) {

						torqueAmp = 0;
						frequency = 0;
						frequencyEnd = 0;
						numSteps = 0;
						user_data_1.r[0] = 0; //0 if not sweep testing

					}
				}
			}

			//pass back for plotting purposes
			user_data_1.r[2] = torqueDes;

		} else if (frequency == 0){
			timer = 0;
			setMotorTorque(actx, torqueAmp);

			stepTimer = 0;
			currentFrequency = 0;
			user_data_1.r[2] = torqueAmp;
		} else {
			timer = 0;
			setMotorTorque(actx, 0);

			stepTimer = 0;
			currentFrequency = 0;
			user_data_1.r[2] = 0;
		}

		user_data_1.r[3] = frequency;

//		rigid1.mn.genVar[5] = frequency; //hz

//		rigid1.mn.genVar[9] = user_data_1.r[2]*1000; //mNm

}

#endif 	//BOARD_TYPE_FLEXSEA_MANAGE || defined BOARD_TYPE_FLEXSEA_PLAN
#endif //INCLUDE_UPROJ_MIT_DLEG || defined BOARD_TYPE_FLEXSEA_PLAN
